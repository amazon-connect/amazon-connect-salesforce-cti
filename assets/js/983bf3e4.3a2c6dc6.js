"use strict";(self.webpackChunkamazon_connect_salesforce_cti=self.webpackChunkamazon_connect_salesforce_cti||[]).push([[2605],{935:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>g,contentTitle:()=>l,default:()=>y,frontMatter:()=>r,metadata:()=>s,toc:()=>c});var a=n(8168),o=(n(6540),n(5680)),i=n(6025);const r={id:"01-installation",title:"Installing the CTI Adapter and Salesforce Lambdas"},l=void 0,s={unversionedId:"lightning/installation/01-installation",id:"lightning/installation/01-installation",title:"Installing the CTI Adapter and Salesforce Lambdas",description:"Amazon Connect Salesforce CTI Adapter Managed Package",source:"@site/docs/lightning/02-installation/01-installation.md",sourceDirName:"lightning/02-installation",slug:"/lightning/installation/01-installation",permalink:"/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation",draft:!1,editUrl:"https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/02-installation/01-installation.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{id:"01-installation",title:"Installing the CTI Adapter and Salesforce Lambdas"},sidebar:"lightning",previous:{title:"Key Benefits and Requirements",permalink:"/amazon-connect-salesforce-cti/docs/lightning/introduction/01-key-benefits"},next:{title:"Setting Up The CTI Adapter Using Guided Setup",permalink:"/amazon-connect-salesforce-cti/docs/lightning/installation/02-guided-setup"}},g={},c=[{value:"Amazon Connect Salesforce CTI Adapter Managed Package",id:"amazon-connect-salesforce-cti-adapter-managed-package",level:3},{value:"Amazon Connect Salesforce Lambda package",id:"amazon-connect-salesforce-lambda-package",level:3},{value:"Setting up the ExecuteAwsService Named Credential",id:"setting-up-the-executeawsservice-named-credential",level:3}],p={toc:c},m="wrapper";function y(e){let{components:t,...n}=e;return(0,o.yg)(m,(0,a.A)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,o.yg)("h3",{id:"amazon-connect-salesforce-cti-adapter-managed-package"},"Amazon Connect Salesforce CTI Adapter Managed Package"),(0,o.yg)("p",null,"The Amazon Connect CTI Adapter for Salesforce provides the core\nintegration between the two platforms. It embeds the Amazon Connect\nContact Control Panel into Salesforce which provides telephony control\nas well as access to event data coming from Amazon Connect. Using this\nadapter, you can configure screen pops based on customer data, automate\ncontact center telephony functions like click-to-dial, and establish\npresence syncing rules for integration with Salesforce Omni-Channel.\nThis is the base of the integration."),(0,o.yg)("p",null,"The first step in the deployment of the integration is to install the\nAmazon Connect CTI Adapter managed package from the AppExchange\nMarketplace."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,o.yg)("strong",{parentName:"p"},"Setup"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the ",(0,o.yg)("strong",{parentName:"p"},"Quick Find"),", type ",(0,o.yg)("strong",{parentName:"p"},"AppExchange")," (the results will\npopulate without hitting enter)")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Select ",(0,o.yg)("strong",{parentName:"p"},"AppExchange Marketplace")," from the links provided")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the AppExchange window, enter ",(0,o.yg)("strong",{parentName:"p"},"Amazon Connect")," into the\n",(0,o.yg)("strong",{parentName:"p"},"Search AppExchange")," field and press enter")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the ",(0,o.yg)("strong",{parentName:"p"},"Search Results"),", select ",(0,o.yg)("strong",{parentName:"p"},"Amazon Connect CTI Adapter")))),(0,o.yg)("img",{src:(0,i.A)("/img/shared/image09.png")}),(0,o.yg)("ol",{start:6},(0,o.yg)("li",{parentName:"ol"},"On the ",(0,o.yg)("strong",{parentName:"li"},"Amazon Connect CTI Adapter")," detail page, select ",(0,o.yg)("strong",{parentName:"li"},"Get It\nNow"))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image4.png")}),(0,o.yg)("ol",{start:7},(0,o.yg)("li",{parentName:"ol"},"If you are presented with the Log In to AppExchange screen, select\n",(0,o.yg)("strong",{parentName:"li"},"Open Login Screen"),". You should then be presented with an Allow\nAccess Screen. Choose ",(0,o.yg)("strong",{parentName:"li"},"Allow"))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image5.png")}),(0,o.yg)("ol",{start:8},(0,o.yg)("li",{parentName:"ol"},"On the ",(0,o.yg)("strong",{parentName:"li"},"Where do you want to install\xa0Amazon Connect CTI Adapter"),"\npage, choose the ",(0,o.yg)("strong",{parentName:"li"},"Install Here")," button in the Install in This Org\nsection")),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image6.png")}),(0,o.yg)("ol",{start:9},(0,o.yg)("li",{parentName:"ol"},"On the ",(0,o.yg)("strong",{parentName:"li"},"Confirm installation details")," screen, fill out the ",(0,o.yg)("strong",{parentName:"li"},"Tell\nus about yourself")," form, check the box to ",(0,o.yg)("strong",{parentName:"li"},"agree with the terms\nand conditions"),", and optionally select the box to ",(0,o.yg)("strong",{parentName:"li"},"allow the\nprovider to contact you"),". Then select ",(0,o.yg)("strong",{parentName:"li"},"Confirm and Install"))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image7.png")}),(0,o.yg)("ol",{start:10},(0,o.yg)("li",{parentName:"ol"},"Select ",(0,o.yg)("strong",{parentName:"li"},"Install for Admins Only"),", then choose ",(0,o.yg)("strong",{parentName:"li"},"Install"),". ",(0,o.yg)("strong",{parentName:"li"},"THIS SELECTION IS VERY IMPORTANT")," - if you select the wrong option, then standard users may have access to objects and pages that they shouldn't have access to.")),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image8.png")}),(0,o.yg)("ol",{start:11},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"The CTI Adapter will take some time to install. While it installs,\nyou will be presented with the ",(0,o.yg)("strong",{parentName:"p"},"This app is taking a long time to\ninstall screen."))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Choose ",(0,o.yg)("strong",{parentName:"p"},"Done"),"."))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image9.png")}),(0,o.yg)("ol",{start:13},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Once you receive confirmation that the ",(0,o.yg)("strong",{parentName:"p"},"installation has\ncompleted")," via email, return to the browser")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Close the ",(0,o.yg)("strong",{parentName:"p"},"Amazon Connect CTI Adapter")," detail page (if still open)")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In Quick Find, enter ",(0,o.yg)("strong",{parentName:"p"},"Installed"),", then select Installed Packages\nfrom the result"))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image10.png")}),(0,o.yg)("ol",{start:16},(0,o.yg)("li",{parentName:"ol"},"Once the ",(0,o.yg)("strong",{parentName:"li"},"Installed Packages")," page opens, validate that the\n",(0,o.yg)("strong",{parentName:"li"},"Amazon Connect -- Universal Package")," is installed")),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image11.png")}),(0,o.yg)("h3",{id:"amazon-connect-salesforce-lambda-package"},"Amazon Connect Salesforce Lambda package"),(0,o.yg)("p",null,"The Amazon Connect Salesforce Lambda package adds considerable\ncapability to the integration. It includes data connectivity between\nAmazon Connect and Salesforce for typical tasks like lookups, case\ncreation, and updates. Additionally, it adds new features like real-time\nand historical data imports, contact trace record imports, recording\nimport, transcription, and contact analytics functions. These\ncapabilities are configurable and can be activated or deactivated on a\ncall-by-call basis."),(0,o.yg)("p",null,"The Amazon Connect Salesforce Lambda package is delivered via the AWS\nServerless Application Repository. The AWS Serverless Application\nRepository enables you to quickly deploy code samples, components, and\ncomplete applications. Each application is packaged with an AWS\nServerless Application Model (SAM) template that defines the AWS\nresources used. There is no additional charge to use the Serverless\nApplication Repository - you only pay for the AWS resources used in the\napplications you deploy."),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In a new browser tab, login to the ",(0,o.yg)("a",{parentName:"p",href:"https://console.aws.amazon.com/"},"AWS\nconsole"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Make sure you are in the same region as your Amazon Connect instance")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Once you have selected the region, navigate to the ",(0,o.yg)("a",{parentName:"p",href:"https://console.aws.amazon.com/connect/home"},"Amazon Connect\nConsole"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Verify that the Amazon Connect instance that you wish to configure\nis listed")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Once you have verified your Amazon Connect instance, Open the\n",(0,o.yg)("a",{parentName:"p",href:"https://console.aws.amazon.com/serverlessrepo/home"},"Serverless Application Repository\nConsole"))),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"In the left navigation, select ",(0,o.yg)("strong",{parentName:"p"},"Available Applications")))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image78.png")}),(0,o.yg)("ol",{start:7},(0,o.yg)("li",{parentName:"ol"},"In the search area, make sure that ",(0,o.yg)("strong",{parentName:"li"},"Public applications")," is\nselected, check the box for ",(0,o.yg)("strong",{parentName:"li"},"Show apps that create custom IAM roles\nor resource policies"),", and enter ",(0,o.yg)("strong",{parentName:"li"},"Salesforce")," in the search\nfield, this will automatically filter the available packages")),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image79.png")}),(0,o.yg)("ol",{start:8},(0,o.yg)("li",{parentName:"ol"},"Select AmazonConnectSalesForceLambda")),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image80.png")}),(0,o.yg)("ol",{start:9},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"When the Application loads, scroll down to the ",(0,o.yg)("strong",{parentName:"p"},"Application\nsettings")," section")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"If you would like to use the Guided Setup feature, ",(0,o.yg)("strong",{parentName:"p"},"don't change any parameters in the template")," and select ",(0,o.yg)("strong",{parentName:"p"},"Deploy"),",\nand wait for the stack to finish deployment. Then, follow the section below on setting up the ExecuteAwsService named credential.\nIf you are not using the Guided Setup feature, navigate to ",(0,o.yg)("a",{parentName:"p",href:"/docs/lightning/installation/03-managed-package-manual-setup"},"here")," for manual setup instructions (skipping the rest of the instructions on the page)."))),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image81.png")}),(0,o.yg)("h3",{id:"setting-up-the-executeawsservice-named-credential"},"Setting up the ExecuteAwsService Named Credential"),(0,o.yg)("p",null,"The ExecuteAwsService Named Credential is the entrypoint for the CTI Adapter to communicate with your AWS account.\nThe Apex code uses the Named Credential to call the ",(0,o.yg)("inlineCode",{parentName:"p"},"sfExecuteAwsService.py")," lambda, which uses boto3 to make changes\nin and retrieve data from your AWS account. Setting up this Named Credential is ",(0,o.yg)("strong",{parentName:"p"},"not required")," if you do not wish\nto use the features that rely on it (Guided Setup and Contact Lens). In addition, you can alter the permissions given\nto the ",(0,o.yg)("inlineCode",{parentName:"p"},"sfExecuteAwsService")," lambda to match your security requirements (NOTE: if you choose to do so, do so after you\nconfigure up the lambdas as some permissions are added/removed based on how the lambdas are configured)."),(0,o.yg)("p",null,"Before you create the ExecuteAwsService Named Credential, ",(0,o.yg)("strong",{parentName:"p"},"confirm that the application was installed for admins only"),". If not, then standard users may be able to invoke methods that call named credentials. If you did this by accident, then you will have to ",(0,o.yg)("a",{parentName:"p",href:"/docs/lightning/installation/06-adapter-installation-troubleshooting#how-to-remove-permissions-to-visualforce-pages-apex-classes-for-a-desired-profile"},"manually edit the profiles")," to remove the permissions to the objects and pages created by the app."),(0,o.yg)("img",{src:(0,i.A)("/img/lightning/image8.png")}),(0,o.yg)("ol",null,(0,o.yg)("li",{parentName:"ol"},"Navigate to the IAM console in your AWS account, select the ",(0,o.yg)("strong",{parentName:"li"},"Users")," tab, and select ",(0,o.yg)("strong",{parentName:"li"},"Add Users")," to create a new user.")),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation0.png")}),(0,o.yg)("ol",{start:2},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Give your IAM user a name (like ",(0,o.yg)("em",{parentName:"p"},"sfExecuteAwsServiceIamUser"),"). For the Access type, select ",(0,o.yg)("strong",{parentName:"p"},"Programmatic access"),". Click Next.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Select ",(0,o.yg)("strong",{parentName:"p"},"Attach existing policies directly"),", then search for and select ",(0,o.yg)("em",{parentName:"p"},"invokeSfExecuteAWSServicePolicy"),"."))),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation1.png")}),(0,o.yg)("ol",{start:4},(0,o.yg)("li",{parentName:"ol"},"Click next until the user is created. In the final screen, copy down the ",(0,o.yg)("strong",{parentName:"li"},"Access Key ID")," and the ",(0,o.yg)("strong",{parentName:"li"},"Secret Access Key"),".")),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation2.png")}),(0,o.yg)("ol",{start:5},(0,o.yg)("li",{parentName:"ol"},"Next, navigate to the Lambda Console. In the functions tab, search for ",(0,o.yg)("em",{parentName:"li"},"sfExecuteAwsService"),".")),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation3.png")}),(0,o.yg)("ol",{start:6},(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Copy down the name of the function. Make sure you are not copying any extra characters.")),(0,o.yg)("li",{parentName:"ol"},(0,o.yg)("p",{parentName:"li"},"Navigate to your setup section of your Salesforce instance, and search for ",(0,o.yg)("em",{parentName:"p"},"Named Credentials"),"."))),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation_legacy_NC.png")}),(0,o.yg)("ol",{start:8},(0,o.yg)("li",{parentName:"ol"},"Select ",(0,o.yg)("strong",{parentName:"li"},"New Legacy"),". For the values in the next screen, enter the following:")),(0,o.yg)("ul",null,(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Label"),": ExecuteAwsService"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"URL"),": ",(0,o.yg)("inlineCode",{parentName:"li"},"https://lambda.{insert AWS region}.amazonaws.com/2015-03-31/functions/{insert lambda function name (copied above)}/invocations")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Identity Type"),": Named Principle"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"Authentication Protocol"),": AWS Signature Version 4"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"AWS Access Key ID"),": ",(0,o.yg)("strong",{parentName:"li"},"Access Key ID")," copied above"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"AWS Secret Access Key"),": ",(0,o.yg)("strong",{parentName:"li"},"Secret Access Key")),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"AWS Region"),": {insert AWS region}"),(0,o.yg)("li",{parentName:"ul"},(0,o.yg)("strong",{parentName:"li"},"AWS Service"),": lambda")),(0,o.yg)("img",{src:(0,i.A)("/img/shared/installation5.png")}),(0,o.yg)("ol",{start:9},(0,o.yg)("li",{parentName:"ol"},"Click ",(0,o.yg)("strong",{parentName:"li"},"Save"),".")),(0,o.yg)("p",null,"After following the above instructions, follow ",(0,o.yg)("a",{parentName:"p",href:"/docs/lightning/installation/02-guided-setup"},"these instructions")," to navigate to the Guided Setup feature."))}y.isMDXComponent=!0},5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>d});var a=n(6540);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var s=a.createContext({}),g=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=g(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},y=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=g(n),y=o,d=p["".concat(s,".").concat(y)]||p[y]||m[y]||i;return n?a.createElement(d,r(r({ref:t},c),{},{components:n})):a.createElement(d,r({ref:t},c))}));function d(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=y;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:o,r[1]=l;for(var g=2;g<i;g++)r[g]=n[g];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}y.displayName="MDXCreateElement"}}]);