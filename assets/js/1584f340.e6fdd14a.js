"use strict";(self.webpackChunkamazon_connect_salesforce_cti=self.webpackChunkamazon_connect_salesforce_cti||[]).push([[3039],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>u});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),p=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(s.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),k=p(a),u=r,g=k["".concat(s,".").concat(u)]||k[u]||m[u]||i;return a?n.createElement(g,l(l({ref:t},c),{},{components:a})):n.createElement(g,l({ref:t},c))}));function u(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,l=new Array(i);l[0]=k;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var p=2;p<i;p++)l[p]=a[p];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}k.displayName="MDXCreateElement"},5560:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>k,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var n=a(7462),r=(a(7294),a(3905)),i=a(4996);const l={id:"04-salesforce-lambdas-manual-setup",title:"Setting Up The Salesforce Lambdas Manually"},o=void 0,s={unversionedId:"classic/installation/04-salesforce-lambdas-manual-setup",id:"classic/installation/04-salesforce-lambdas-manual-setup",title:"Setting Up The Salesforce Lambdas Manually",description:"Below are manual setup instructions for the Salesforce Lambdas.",source:"@site/docs/classic/02-installation/04-salesforce-lambdas-manual-setup.md",sourceDirName:"classic/02-installation",slug:"/classic/installation/04-salesforce-lambdas-manual-setup",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/04-salesforce-lambdas-manual-setup",draft:!1,editUrl:"https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/classic/02-installation/04-salesforce-lambdas-manual-setup.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{id:"04-salesforce-lambdas-manual-setup",title:"Setting Up The Salesforce Lambdas Manually"},sidebar:"classic",previous:{title:"Setting Up The CTI Adapter Managed Package Manually",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/03-managed-package-manual-setup"},next:{title:"Upgrading from an Earlier Version",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/05-upgrading-from-an-earlier-version"}},p={},c=[{value:"Salesforce Lambda Prerequisites",id:"salesforce-lambda-prerequisites",level:2},{value:"Determine your production Environment",id:"determine-your-production-environment",level:3},{value:"Determine your Consumer Key and Secret",id:"determine-your-consumer-key-and-secret",level:3},{value:"Determine your Username, Password and Security Token",id:"determine-your-username-password-and-security-token",level:3},{value:"Allowing the API user to authenticate using password",id:"allowing-the-api-user-to-authenticate-using-password",level:3},{value:"Store Salesforce credentials in AWS Secrets Manager",id:"store-salesforce-credentials-in-aws-secrets-manager",level:3},{value:"Install the Amazon Connect Salesforce Lambda package",id:"install-the-amazon-connect-salesforce-lambda-package",level:2},{value:"Compatibility Table",id:"compatibility-table",level:3},{value:"Instructions",id:"instructions",level:4}],m={toc:c};function k(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"Below are manual setup instructions for the Salesforce Lambdas."),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image100.png")}),(0,r.kt)("h2",{id:"salesforce-lambda-prerequisites"},"Salesforce Lambda Prerequisites"),(0,r.kt)("p",null,"Consider the following prerequisites before you install the Lambda\npackage."),(0,r.kt)("h3",{id:"determine-your-production-environment"},"Determine your production Environment"),(0,r.kt)("p",null,'In your installation notes, enter the value for "Production Environment"\nas "true" or "false", depending on whether the Salesforce environment\nthat you are deploying the package into is a production or a sandbox.\nFor Production, enter "true". For Sandbox enter "false".'),(0,r.kt)("h3",{id:"determine-your-consumer-key-and-secret"},"Determine your Consumer Key and Secret"),(0,r.kt)("p",null,"To leverage the full potential of the integration, Salesforce data needs\nto be accessed from AWS environment. The AWS Serverless package comes\nwith a set of pre-built queries to lookup, update and create Salesforce\nobjects within Amazon Connect Contact Flows, in form of AWS Lambda\nfunctions."),(0,r.kt)("p",null,"The Lambda function access Salesforce using the Salesforce REST API. To\nget access to the environment, a Connected App must be configured with\nOAuth settings enabled."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Create ",">"," Apps"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image101.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click on the "New" button for the Connected Apps at the bottom of the page')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'In the following form, fill out the Connected App Name, API Name and Contact Email with values of your choice. We recommend "Amazon Connect Integration" as the Connected App Name and the default value for the API name.'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image102.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},'Select the checkbox next to "Enable OAuth Settings" as shown below.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image103.png")}),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"Set the ",(0,r.kt)("strong",{parentName:"li"},"Callback URL")," to your domain url. Find the domain at ",(0,r.kt)("em",{parentName:"li"},"Setup")," -> ",(0,r.kt)("em",{parentName:"li"},"My Domain"),".")),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image293.png")}),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Ensure Selected OAuth Scopes has the following values selected:")),(0,r.kt)("p",null,"a.  Access the identity URL service (id, profile, email, address, phone)"),(0,r.kt)("p",null,"b.  Manage user data via APIs (api)"),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},'Select the checkbox "Require Secret for Web Server Flow", and the checkbox "Require Secret For Refresh Token Flow"')),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/guidedsetup4.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the screen.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Continue" on the next screen'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image107.png")}),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},'Once the app has been created, on the app\'s detail screen, please copy the "Consumer Key" value to your installation notes')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image108.png")}),(0,r.kt)("ol",{start:12},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Select "Click to reveal" next to Consumer Secret and record this value to "Consumer Secret" in your installation notes.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Manage" at the top of the page'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image109.png")}),(0,r.kt)("ol",{start:14},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'On the page that appears, click "Edit Policies"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Set "Permitted Users" to "Admin approved users are pre-authorizes"'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image110.png")}),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},'Click "OK" on the pop-up dialog:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image111.png")}),(0,r.kt)("ol",{start:17},(0,r.kt)("li",{parentName:"ol"},'Set "IP Relaxation" to "Relax IP restrictions"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image112.png")}),(0,r.kt)("ol",{start:18},(0,r.kt)("li",{parentName:"ol"},'Click "Save"')),(0,r.kt)("h3",{id:"determine-your-username-password-and-security-token"},"Determine your Username, Password and Security Token"),(0,r.kt)("p",null,"The authentication of the Lambda Functions requires valid user\ncredentials. It is a common practice to create an API user account for\nthis purpose."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Profiles")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "New Profile"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Enter the Profile Name (i.e. "API Only")')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the existing profile to clone (The integration user\\'s access to just those objects required for the integration)"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image113.png")}),(0,r.kt)("p",null,"NOTE: You\\'re advised to use a full Salesforce License for the user to\nbe able to set the below permissions and have full access to avoid any\nother errors."),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},'Click "Save". A New Profile is created:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image114.png")}),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Once the new profile page opens, select the ",(0,r.kt)("strong",{parentName:"li"},"System Permissions")," button")),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/usersetup1.png")}),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"If the Lightning Experience User checkbox is selected, clear it")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image117.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Save the system permissions, then go back to Profile Overview")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the ",(0,r.kt)("em",{parentName:"p"},"Password Policies")," link, click edit"))),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/usersetup2.png")}),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image115.png")}),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},"Set ",(0,r.kt)("strong",{parentName:"li"},"User password expire in")," to ",(0,r.kt)("strong",{parentName:"li"},"Never expires")," ",(0,r.kt)("strong",{parentName:"li"},"NOTE:")," Failure to this may lead to production outages.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image116.png")}),(0,r.kt)("ol",{start:12},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Save"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Apps ",">"," Connected Apps")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the app you have created in the previous step (i.e. Amazon Connect Integration)"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image118.png")}),(0,r.kt)("ol",{start:15},(0,r.kt)("li",{parentName:"ol"},'Click "Manage Profiles"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image119.png")}),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},'Ensure the "API Only" profile is selected:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image120.png")}),(0,r.kt)("ol",{start:17},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the page')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Users")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "New User"'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image121.png")}),(0,r.kt)("ol",{start:20},(0,r.kt)("li",{parentName:"ol"},"Set necessary fields: Last Name, Alias, Email, Username, Nickname")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image122.png")}),(0,r.kt)("ol",{start:21},(0,r.kt)("li",{parentName:"ol"},"On the right-hand side, set the User License and Profile")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image123.png")}),(0,r.kt)("ol",{start:22},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In ",(0,r.kt)("strong",{parentName:"p"},"Quick Find"),', search for "Permission Sets". Select the ',(0,r.kt)("strong",{parentName:"p"},"AC_Administrator")," permission set."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/lambda-install-0.png")}),(0,r.kt)("ol",{start:24},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Manage Assignments"),". Add the apiuser you just created to the permission set.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"A confirmation email will be sent, with an activation link. Click the link to activate your user."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image124.png")}),(0,r.kt)("p",null,"Change (set) a password for apiuser (Considered a strong that contains\nat least 20 random characters):"),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image125.png")}),(0,r.kt)("ol",{start:26},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Change Password"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Access the apiuser personal settings by selecting the username in the top right corner, then "My Settings".'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image126.png")}),(0,r.kt)("ol",{start:28},(0,r.kt)("li",{parentName:"ol"},'Type "Security Token" in the Quick Find box and click "Reset My Security Token".')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image127.png")}),(0,r.kt)("ol",{start:29},(0,r.kt)("li",{parentName:"ol"},"Your security token will be emailed to you")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image128.png")}),(0,r.kt)("ol",{start:30},(0,r.kt)("li",{parentName:"ol"},'Copy the security token from the email in to your installation notes for the "Access Token" value.')),(0,r.kt)("h3",{id:"allowing-the-api-user-to-authenticate-using-password"},"Allowing the API user to authenticate using password"),(0,r.kt)("p",null,"The api user created above authenticates using username-password flow in Salesforce. This flow needs to be unblocked and to do that, go to ",(0,r.kt)("em",{parentName:"p"},"Setup")," and in the Quick Find box, search for ",(0,r.kt)("strong",{parentName:"p"},"OAuth and OpenID Connect Settings"),". After that, make sure that the toggles for ",(0,r.kt)("strong",{parentName:"p"},"Allow OAuth Username-Password Flows")," and ",(0,r.kt)("strong",{parentName:"p"},"Allow OAuth User-Agent Flows")," are turned ON, as shown in below image."),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image292.png")}),(0,r.kt)("h3",{id:"store-salesforce-credentials-in-aws-secrets-manager"},"Store Salesforce credentials in AWS Secrets Manager"),(0,r.kt)("p",null,"To ensure that your Salesforce credentials are secure, the Lambdas\nrequire that the credentials are stored in AWS Secrets Manager. AWS\nSecrets Manager is a highly secure service that helps you store and\nretrieve secrets."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In a new browser tab, login to the AWS console")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure you are in the same region as your Amazon Connect\ninstance. You can set the region by expanding the region selector in\nthe upper right and choosing the region"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image129.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to the ",(0,r.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/secretsmanager/home"},"Secrets Manager\nconsole"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Secrets"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Store a new secret"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Other types of secrets"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure ",(0,r.kt)("strong",{parentName:"p"},"Secret key/value")," is selected")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enter key value pairs that match the following:"),(0,r.kt)("p",{parentName:"li"},"a.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," Password, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the password for the API user that\nyou configured in the previous section"),(0,r.kt)("p",{parentName:"li"},"b.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," ConsumerKey, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the Consumer Key for the\nConnected App you created in the previous section"),(0,r.kt)("p",{parentName:"li"},"c.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," ConsumerSecret, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the Consumer Secret for the\nConnected App you created in the previous section"),(0,r.kt)("p",{parentName:"li"},"d.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," AccessToken, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," this is the access token for\nthe API user that you configured in the previous section")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'For the encryption key, click "Add new key"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Create Key"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure key type is set to ",(0,r.kt)("strong",{parentName:"p"},"symmetric"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Give your key an ",(0,r.kt)("strong",{parentName:"p"},"alias"),", like\n",(0,r.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select administrators you want to have access permission to change\nthe key policy. Make sure you are being as restrictive as possible")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the users and roles you want to have access to the Salesforce\ncredentials in Secrets Manager. Make sure you are being as\nrestrictive as possible")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Finish")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate back to the Secrets Manager setup tab")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the key you just created"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image130.png")}),(0,r.kt)("ol",{start:21},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Give your secret a name, like ",(0,r.kt)("em",{parentName:"p"},"SalesforceCredentials"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure ",(0,r.kt)("strong",{parentName:"p"},"automatic rotation")," is disabled.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Store")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the secret you just created, and copy the Secret ARN"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image131.png")}),(0,r.kt)("ol",{start:28},(0,r.kt)("li",{parentName:"ol"},"You should now have all of the information you need to install the\npackage")),(0,r.kt)("h2",{id:"install-the-amazon-connect-salesforce-lambda-package"},"Install the Amazon Connect Salesforce Lambda package"),(0,r.kt)("h3",{id:"compatibility-table"},"Compatibility Table"),(0,r.kt)("p",null,"The following table instructs users on the best CTI Adapter version to\nuse with the corresponding lambda version. If a minor version for the CTI Adapter is not\nlisted (ex. v5.21.1), it will be grouped with with its major version unless otherwise specified"),(0,r.kt)("table",null,(0,r.kt)("tr",null,(0,r.kt)("th",null,"CTI Adapter Version"),(0,r.kt)("th",null,"Lambda Version")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.24"),(0,r.kt)("td",null,"v5.22")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.23.3"),(0,r.kt)("td",null,"v5.22")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.22"),(0,r.kt)("td",null,"v5.22")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.21"),(0,r.kt)("td",null,"v5.19 - v5.19.7")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.20"),(0,r.kt)("td",null,"v5.19 - v5.19.7")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.19"),(0,r.kt)("td",null,"v5.19 - v5.19.7")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.18"),(0,r.kt)("td",null,"v5.18")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.17"),(0,r.kt)("td",null,"v5.17")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.16"),(0,r.kt)("td",null,"v5.16")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.15"),(0,r.kt)("td",null,"v5.15")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.14"),(0,r.kt)("td",null,"v5.14")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.13"),(0,r.kt)("td",null,"v5.13")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.12"),(0,r.kt)("td",null,"v5.11 - v5.12")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.11"),(0,r.kt)("td",null,"v5.11 - v5.12")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.10"),(0,r.kt)("td",null,"v5.10")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.9"),(0,r.kt)("td",null,"v5.9")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.7"),(0,r.kt)("td",null,"v5.7 - v5.8")),(0,r.kt)("tr",null,(0,r.kt)("td",null,"v5.6"),(0,r.kt)("td",null,"v5.7 - v5.8"))),(0,r.kt)("h4",{id:"instructions"},"Instructions"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Login into your AWS Account")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate AWS Serverless Application Repository\n(",(0,r.kt)("a",{parentName:"p",href:"https://aws.amazon.com/serverless/serverlessrepo/"},"https://aws.amazon.com/serverless/serverlessrepo/"),")"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image132.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Click on the Search (magnifying glass) and type in Amazon Connect\nSalesforce.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image133.png")}),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},'Select AmazonConnectSalesForceLambdas and click "Deploy"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image134.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},'Fill in all Salesforce related fields in "Configure application\nparameters".\\\nAll values should be available in your installation notes:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image135.png")}),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image136.png")}),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"The Lambda package includes additional features which can be enabled\nor disabled, based on particular use-case:"),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Application name:")," You can accept the default here or change\nit as desired")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"AmazonConnectInstanceId:")," You Amazon Connect Instance Id.\nOnly required if you enable real time reporting")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"CTRKinesisARN:")," This is the ARN for the Kinesis stream that\nwas configured for Contact Trace Record streaming in Amazon\nConnect. This is the complete ARN. Amazon Kinesis Firehose is\nnot supported.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"ConnectReportingS3BucketName:")," This is the name of the S3\nbucket used to store exported reports for your Amazon Connect\ninstance. This is ONLY the bucket name, no sub-folders or\nsuffixes")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"HistoricalReportingImportEnabled:")," true ","|"," false - if set to\ntrue, the package will include a feature to import Amazon\nConnect Queue and Agent Historical Metrics into your Salesforce\nOrg. This feature requires you to provide\n",(0,r.kt)("strong",{parentName:"p"},"ConnectReportingS3BucketName"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"LambdaLoggingLevel:")," DEBUG ","|"," INFO ","|"," WARNING ","|"," ERROR ","|","\nCRITICAL - Logging level for Lambda functions")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PrivateVpcEnabled:")," Set to true if functions should be\ndeployed to a private VPC. Set VpcSecurityGroupList and\nVpcSubnetList if this is set to true.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"RealtimeReportingImportEnabled:")," true ","|"," false - if set to\ntrue, the package will include a feature to publish Amazon\nConnect Queue Metrics into your Salesforce Org. This feature\nrequires you to provide ",(0,r.kt)("strong",{parentName:"p"},"AmazonConnectInstanceId"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceAdapterNamespace:")," This is the namespace for CTI\nAdapter managed package. The default value is ",(0,r.kt)("strong",{parentName:"p"},"amazonconnect"),".\nIf a non-managed package is used, leave this field blank.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceCredentialsKMSKeyARN:")," This is the ARN for KMS\ncustomer managed key that you created in the previous section.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceCredentialsSecretsManagerARN:")," This is the ARN for\nthe Secrets Manager Secret that you created in the previous\nsection.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceHost:")," The full domain for your salesforce org. For\nexample\n",(0,r.kt)("inlineCode",{parentName:"p"},"https://mydevorg-dev-ed.my.salesforce.com"),".\nPlease make sure that the host starts with ",(0,r.kt)("inlineCode",{parentName:"p"},"https"),", and that the url\nends with ",(0,r.kt)("inlineCode",{parentName:"p"},".my.salesforce.com"),". This url can be found in ",(0,r.kt)("inlineCode",{parentName:"p"},"Setup")," -> ",(0,r.kt)("inlineCode",{parentName:"p"},"My Domain"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceProduction:")," true ","|"," false - True for Production\nEnvironment, False for Sandbox")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceUsername:")," The username for the API user that you\nconfigured in the previous section. Salesforce usernames are in the form of an email address.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"SalesforceVersion:")," This is the Salesforce.com API version\nthat you noted in the previous section. The pattern of this value is ",(0,r.kt)("inlineCode",{parentName:"p"},"vXX.X"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"TranscribeOutputS3BucketName:")," This is the S3 bucket where\nAmazon Transcribe stores the output. Typically, this is the same\nbucket that call recordings are stored in, so you can use the\nsame value as found in ",(0,r.kt)("strong",{parentName:"p"},"ConnectRecordingS3BucketName"),". Not\nrequired if PostcallRecordingImportEnabled,\nPostcallTranscribeEnabled, ContactLensImportEnabled set to false.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"VpcSecurityGroupList:")," The list of SecurityGroupIds for\nVirtual Private Cloud (VPC). Not required if PrivateVpcEnabled\nis set to false.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"VpcSubnetList:")," The list of Subnets for the Virtual Private\nCloud (VPC). Not required if PrivateVpcEnabled is set to false.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"AmazonConnectQueueMaxRecords:")," Enter record set size for list\nqueue query. Max is 100.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"AmazonConnectQueueMetricsMaxRecords:")," Enter record set size\nfor queue metrics query. Max is 100.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"CTREventSourceMappingMaximumRetryAttempts:")," Maximum retry\nattempts on failure for lambdas triggered by Kinesis Events.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"ConnectRecordingS3BucketName:")," This is the name of the S3\nbucket used to store recordings for your Amazon Connect\ninstance. This is ONLY the bucket name, no sub-folders or\nsuffixes")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"ContactLensImportEnabled:")," true ","|"," false - Set to false if\nimporting Contact Lens into Salesforce should not be enabled.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PostcallCTRImportEnabled:")," true ","|"," false - Set to false if\nimporting CTRs into Salesforce should not be enabled on the\npackage level. This setting can be disabled on a call-by-call\nbasis.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PostcallRecordingImportEnabled:")," true ","|"," false - Set to false\nif importing call recordings into Salesforce should not be\nenabled on the package level. This setting can be disabled on a\ncall-by-call basis.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"PostcallTranscribeEnabled:")," true ","|"," false - Set to false if\npost-call transcription should not be enabled on the package\nlevel. This setting can be disabled on a call-by-call basis.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"TranscriptionJobCheckWaitTime:")," Time between transcription\njob checks")))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Once completed, click "Deploy" function:'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image137.png")}),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"The package provides a single Lambda function (sfInvokeAPI) that\nsupports multiple operations, like lookup, create and update. For\nthe initial validation, sample events are provided within the\nfunction. Click on the function name and check the list of files in\nthe editor.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image138.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},"To validate a phone number lookup, double-click on\nevent-phoneLookup.json file and copy the text in your clipboard.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image139.png")}),(0,r.kt)("ol",{start:10},(0,r.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image140.png")}),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. phoneLookup)\nand paste the JSON payload you\'ve copied in the previous step.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image141.png")}),(0,r.kt)("ol",{start:12},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Create" button')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'From the drop-down list, select your "eventLookup" and click "Test"\nbutton'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image142.png")}),(0,r.kt)("ol",{start:14},(0,r.kt)("li",{parentName:"ol"},'If successful, the result will contain fields defined in "sf_fields"\nparameter in the invocation event')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image143.png")}),(0,r.kt)("ol",{start:15},(0,r.kt)("li",{parentName:"ol"},'As a next step, we are going to use the ContactId provided and\ncreate a Case in Salesforce. Double-click on "event-create.json"\nfile and set the ContactId value from the previous step. Copy the\nJSON text into your clipboard.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image144.png")}),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image145.png")}),(0,r.kt)("ol",{start:17},(0,r.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. createCase) and\npaste the JSON payload you\'ve copied in the previous step.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image146.png")}),(0,r.kt)("ol",{start:18},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Create" button')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'From the drop-down list, select your "createCase" and click "Test"\nbutton'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image147.png")}),(0,r.kt)("ol",{start:20},(0,r.kt)("li",{parentName:"ol"},"If successful, the result will contain a Case Id for newly created\ncase:")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image148.png")}),(0,r.kt)("ol",{start:21},(0,r.kt)("li",{parentName:"ol"},'As defined in the event payload, Status is "New" and Priority is\n"Low". We are going to use the update operation to close the case.\nCopy the Case Id provided in the previous step, then double-click on\n"event-update.json" file and paste the Case Id in "sf_id" parameter:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image149.png")}),(0,r.kt)("ol",{start:22},(0,r.kt)("li",{parentName:"ol"},'In the top-right corner, click the drop-down arrow next to the\n"Test" button and select "Configure test events"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image150.png")}),(0,r.kt)("ol",{start:23},(0,r.kt)("li",{parentName:"ol"},'Select "Create new test event", set Event name (i.e. closeCase) and\npaste the JSON payload you\'ve copied in the previous step.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image151.png")}),(0,r.kt)("ol",{start:24},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Create" button')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'From the drop-down list, select your "closeCase" and click "Test"\nbutton'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image152.png")}),(0,r.kt)("ol",{start:26},(0,r.kt)("li",{parentName:"ol"},'If successful, the result will be HTTP code 204 ("No Content"\nsuccess code):')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image153.png")}),(0,r.kt)("ol",{start:27},(0,r.kt)("li",{parentName:"ol"},'Login in to Salesforce and search for Case and it\'s details. The\nCase status should be "Closed".')))}k.isMDXComponent=!0}}]);