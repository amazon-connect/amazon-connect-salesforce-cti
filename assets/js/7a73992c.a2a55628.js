"use strict";(self.webpackChunkamazon_connect_salesforce_cti=self.webpackChunkamazon_connect_salesforce_cti||[]).push([[716],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>k});var n=a(7294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var l=n.createContext({}),p=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},c=function(e){var t=p(e.components);return n.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},g=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,l=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),g=p(a),k=r,u=g["".concat(l,".").concat(k)]||g[k]||m[k]||i;return a?n.createElement(u,s(s({ref:t},c),{},{components:a})):n.createElement(u,s({ref:t},c))}));function k(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,s=new Array(i);s[0]=g;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o.mdxType="string"==typeof e?e:r,s[1]=o;for(var p=2;p<i;p++)s[p]=a[p];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}g.displayName="MDXCreateElement"},5671:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>g,frontMatter:()=>s,metadata:()=>l,toc:()=>c});var n=a(7462),r=(a(7294),a(3905)),i=a(4996);const s={id:"02-guided-setup",title:"Setting Up The CTI Adapter Using Guided Setup"},o=void 0,l={unversionedId:"classic/installation/02-guided-setup",id:"classic/installation/02-guided-setup",title:"Setting Up The CTI Adapter Using Guided Setup",description:"In order to navigate to the Guided Setup feature, perform the following steps (NOTE",source:"@site/docs/classic/02-installation/02-guided-setup.md",sourceDirName:"classic/02-installation",slug:"/classic/installation/02-guided-setup",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/02-guided-setup",draft:!1,editUrl:"https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/classic/02-installation/02-guided-setup.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{id:"02-guided-setup",title:"Setting Up The CTI Adapter Using Guided Setup"},sidebar:"classic",previous:{title:"Installing the CTI Adapter and Salesforce Lambdas",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/01-installation"},next:{title:"Setting Up The CTI Adapter Managed Package Manually",permalink:"/amazon-connect-salesforce-cti/docs/classic/installation/03-managed-package-manual-setup"}},p={},c=[{value:"Guided Setup Prerequisites",id:"guided-setup-prerequisites",level:2},{value:"Create Named Credential",id:"create-named-credential",level:3},{value:"Create Connected App",id:"create-connected-app",level:3},{value:"Guided Setup Additional Instructions",id:"guided-setup-additional-instructions",level:2},{value:"Retrieve Amazon Connect Instance Url",id:"retrieve-amazon-connect-instance-url",level:3},{value:"Add users to the Call Center",id:"add-users-to-the-call-center",level:3},{value:"Add users to a Permission Set",id:"add-users-to-a-permission-set",level:3},{value:"AC_Administrator",id:"ac_administrator",level:4},{value:"AC_Manager",id:"ac_manager",level:4},{value:"AC_Agent",id:"ac_agent",level:4},{value:"Create the Softphone Layout",id:"create-the-softphone-layout",level:3},{value:"Retrieve the Salesforce API Version",id:"retrieve-the-salesforce-api-version",level:3},{value:"Setting up the Salesforce API User",id:"setting-up-the-salesforce-api-user",level:3},{value:"Allowing the API user to authenticate using password",id:"allowing-the-api-user-to-authenticate-using-password",level:3},{value:"Setting up the SecretsManager Secret",id:"setting-up-the-secretsmanager-secret",level:3}],m={toc:c};function g(e){let{components:t,...a}=e;return(0,r.kt)("wrapper",(0,n.Z)({},m,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/guidedsetup0.png")}),(0,r.kt)("p",null,"In order to navigate to the Guided Setup feature, perform the following steps (NOTE: If you are not an admin user then you must first add yourself to the AC_Administrator permission set, see ",(0,r.kt)("a",{parentName:"p",href:"./02-guided-setup#add-users-to-a-permission-set"},"here")," for more details):"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to the Setup section in your Salesforce instance.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Search for Visualforce Pages, and select ",(0,r.kt)("strong",{parentName:"p"},"AC_GuidedSetup"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Preview"),"."))),(0,r.kt)("h2",{id:"guided-setup-prerequisites"},"Guided Setup Prerequisites"),(0,r.kt)("p",null,"The below sections are linked to from the Guided Setup feature. Only perform the below steps when the\nGuided Setup feature links to them."),(0,r.kt)("h3",{id:"create-named-credential"},"Create Named Credential"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"/docs/classic/installation/01-installation#setting-up-the-executeawsservice-named-credential"},"here")," for instructions on setting up the Named Credential."),(0,r.kt)("h3",{id:"create-connected-app"},"Create Connected App"),(0,r.kt)("p",null,"The Lambda function access Salesforce using the Salesforce REST API. To\nget access to the environment, a Connected App must be configured with\nOAuth settings enabled."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Create ",">"," Apps"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image101.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click on the "New" button for the Connected Apps at the bottom of the page')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'In the following form, fill out the Connected App Name, API Name and Contact Email with values of your choice. We recommend "Amazon Connect Integration" as the Connected App Name and the default value for the API name.'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image102.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},'Select the checkbox next to "Enable OAuth Settings" as shown below.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image103.png")}),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"Set the ",(0,r.kt)("strong",{parentName:"li"},"Callback URL")," to your domain url. Find the domain at ",(0,r.kt)("em",{parentName:"li"},"Setup")," -> ",(0,r.kt)("em",{parentName:"li"},"My Domain"),".")),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image293.png")}),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Ensure Selected OAuth Scopes has the following values selected:")),(0,r.kt)("p",null,"a.  Access the identity URL service (id, profile, email, address, phone)"),(0,r.kt)("p",null,"b.  Manage user data via APIs (api)"),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},'Select the checkbox "Require Secret for Web Server Flow", and the checkbox "Require Secret For Refresh Token Flow"')),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/guidedsetup4.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the screen.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Continue" on the next screen'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image107.png")}),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},'Once the app has been created, on the app\'s detail screen, please copy the "Consumer Key" value to your installation notes')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image108.png")}),(0,r.kt)("ol",{start:12},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Select "Click to reveal" next to Consumer Secret and record this value to "Consumer Secret" in your installation notes.')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Manage" at the top of the page'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image109.png")}),(0,r.kt)("ol",{start:14},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'On the page that appears, click "Edit Policies"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Set "Permitted Users" to "Admin approved users are pre-authorizes"'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image110.png")}),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},'Click "OK" on the pop-up dialog:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image111.png")}),(0,r.kt)("ol",{start:17},(0,r.kt)("li",{parentName:"ol"},'Set "IP Relaxation" to "Relax IP restrictions"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image112.png")}),(0,r.kt)("ol",{start:18},(0,r.kt)("li",{parentName:"ol"},'Click "Save"')),(0,r.kt)("h2",{id:"guided-setup-additional-instructions"},"Guided Setup Additional Instructions"),(0,r.kt)("p",null,"The below sections are linked to from the Guided Setup feature. Only perform the below steps when the\nGuided Setup feature links to them."),(0,r.kt)("h3",{id:"retrieve-amazon-connect-instance-url"},"Retrieve Amazon Connect Instance Url"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to the ",(0,r.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/connect/home"},"Amazon Connect\nConsole"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select your Instance Alias")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"On the Overview page for your instance, copy the Login URL\n(if your Amazon Connect instance uses the ",(0,r.kt)("inlineCode",{parentName:"p"},"https://(instancename).awsapps.com/connect/login"),'\ndomain, then remove everything after ".com"):'))),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/image04.png")}),(0,r.kt)("h3",{id:"add-users-to-the-call-center"},"Add users to the Call Center"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,r.kt)("strong",{parentName:"p"},"Setup"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("strong",{parentName:"p"},"Quick Find")," field, enter ",(0,r.kt)("strong",{parentName:"p"},"Call Center"),", then select\n",(0,r.kt)("strong",{parentName:"p"},"Call Centers")," from the result list"))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image28.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"If you see the ",(0,r.kt)("strong",{parentName:"p"},"Say Hello to Salesforce Call Center")," page, select\n",(0,r.kt)("strong",{parentName:"p"},"Continue"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"AC Lightning Adapter")))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image29.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"On the ",(0,r.kt)("strong",{parentName:"p"},"AC Lightning Adapter")," detail page, select ",(0,r.kt)("strong",{parentName:"p"},"Edit"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"On the ",(0,r.kt)("strong",{parentName:"p"},"AC Lightning Adapter: Manage Users")," page, select ",(0,r.kt)("strong",{parentName:"p"},"Add\nMore Users"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Set filters (if desired) and then choose ",(0,r.kt)("strong",{parentName:"p"},"Find"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the checkbox next to the user to add, then choose ",(0,r.kt)("strong",{parentName:"p"},"Add to\nCall Center"),"."))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image30.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},"Repeat the steps to add more users.")),(0,r.kt)("h3",{id:"add-users-to-a-permission-set"},"Add users to a Permission Set"),(0,r.kt)("p",null,"All users must be assigned the required permission set to access\nSalesforce metadata. The Amazon Connect CTI Adapter includes\nPermission Sets-- one for agents, one for managers, one for\nadministrators, and a few for specific features, that grant users\nthe appropriate access for their role. More information on assigning\nuser permissions can be found in the ",(0,r.kt)("a",{parentName:"p",href:"https://help.salesforce.com/articleView?id=perm_sets_mass_assign.htm&type=5"},"Salesforce help\ndocumentation"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in into your Salesforce Org.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to ",(0,r.kt)("strong",{parentName:"p"},"Setup")," ",">"," ",(0,r.kt)("strong",{parentName:"p"},"Manage Users")," ",">"," ",(0,r.kt)("strong",{parentName:"p"},"Permission Sets"),"."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image16.png")}),(0,r.kt)("ol",{start:2},(0,r.kt)("li",{parentName:"ol"},"Choose ",(0,r.kt)("strong",{parentName:"li"},"AC_Manager"),".")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image17.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"Manage Assignments"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"Add Assignments"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the users to assign the permissions, then choose ",(0,r.kt)("strong",{parentName:"p"},"Assign"),". More information on assigning user permissions can be found at: ",(0,r.kt)("a",{parentName:"p",href:"https://help.salesforce.com/articleView?id=perm_sets_mass_assign.htm&type=5"},"https://help.salesforce.com/articleView?id=perm_sets_mass_assign.htm&type=5")))),(0,r.kt)("h4",{id:"ac_administrator"},"AC_Administrator"),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image18.png")}),(0,r.kt)("h4",{id:"ac_manager"},"AC_Manager"),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image19.png")}),(0,r.kt)("h4",{id:"ac_agent"},"AC_Agent"),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image20.png")}),(0,r.kt)("h3",{id:"create-the-softphone-layout"},"Create the Softphone Layout"),(0,r.kt)("p",null,"Next, we need to create a softphone layout for the solution."),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image9.png")}),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("strong",{parentName:"p"},"Quick Find")," box, type ",(0,r.kt)("em",{parentName:"p"},"Softphone Layouts"),", then choose ",(0,r.kt)("strong",{parentName:"p"},"Softphone Layouts"),".")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Choose ",(0,r.kt)("strong",{parentName:"p"},"New"),"."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image10.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Enter a name for the layout, such as ",(0,r.kt)("em",{parentName:"li"},"AmazonConnectDefault"),", then select the ",(0,r.kt)("strong",{parentName:"li"},"Is Default Layout")," checkbox.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image11.png")}),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},'Expand "Display these salesforce.com objects" and select objects that CTI Connector should be able to search, for a screen-pop query. In this example, besides default selection, I\'m adding "Case", as I want to search and screen-pop by CaseID.')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image12.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"If necessary, configure the search behavior in the case that one or multiple records are found upon CTI search.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image13.png")}),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},"In this example, keep the default configuration, then choose\n",(0,r.kt)("strong",{parentName:"li"},"Save"),".")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image14.png")}),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image15.png")}),(0,r.kt)("h3",{id:"retrieve-the-salesforce-api-version"},"Retrieve the Salesforce API Version"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in into your Salesforce org and go to ",(0,r.kt)("strong",{parentName:"p"},"Setup"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In the ",(0,r.kt)("strong",{parentName:"p"},"Quick Find")," field, type ",(0,r.kt)("strong",{parentName:"p"},"apex"),", then select ",(0,r.kt)("strong",{parentName:"p"},"Apex\nClasses")," from the results"))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image56.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},"Select New")),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image57.png")}),(0,r.kt)("ol",{start:4},(0,r.kt)("li",{parentName:"ol"},"Select the Version Settings tab")),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image58.png")}),(0,r.kt)("ol",{start:5},(0,r.kt)("li",{parentName:"ol"},"Note the Salesforce.com API version in your notepad. The pattern of this value is ",(0,r.kt)("inlineCode",{parentName:"li"},"vXX.X"),".")),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image59.png")}),(0,r.kt)("h3",{id:"setting-up-the-salesforce-api-user"},"Setting up the Salesforce API User"),(0,r.kt)("p",null,"The Lambda functions authenticate with Salesforce via user credentials.\nIt is a common practice to create an API user account for this purpose."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Log in to Salesforce")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Profiles")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "New Profile"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Enter the Profile Name (i.e. "API Only")')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the existing profile to clone (The integration user\\'s access to just those objects required for the integration)"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image113.png")}),(0,r.kt)("p",null,"NOTE: You\\'re advised to use a full Salesforce License for the user to\nbe able to set the below permissions and have full access to avoid any\nother errors."),(0,r.kt)("ol",{start:6},(0,r.kt)("li",{parentName:"ol"},'Click "Save". A New Profile is created:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image114.png")}),(0,r.kt)("ol",{start:7},(0,r.kt)("li",{parentName:"ol"},"Once the new profile page opens, select the ",(0,r.kt)("strong",{parentName:"li"},"System Permissions")," button")),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/usersetup1.png")}),(0,r.kt)("ol",{start:8},(0,r.kt)("li",{parentName:"ol"},"If the Lightning Experience User checkbox is selected, clear it")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image117.png")}),(0,r.kt)("ol",{start:9},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Save the system permissions, then go back to Profile Overview")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the ",(0,r.kt)("em",{parentName:"p"},"Password Policies")," link, click edit"))),(0,r.kt)("img",{src:(0,i.Z)("/img/shared/usersetup2.png")}),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image115.png")}),(0,r.kt)("ol",{start:11},(0,r.kt)("li",{parentName:"ol"},"Set ",(0,r.kt)("strong",{parentName:"li"},"User password expire in")," to ",(0,r.kt)("strong",{parentName:"li"},"Never expires")," ",(0,r.kt)("strong",{parentName:"li"},"NOTE:")," Failure to this may lead to production outages.")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image116.png")}),(0,r.kt)("ol",{start:12},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Save"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Apps ",">"," Connected Apps")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the app you have created in the previous step (i.e. Amazon Connect Integration)"))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image118.png")}),(0,r.kt)("ol",{start:15},(0,r.kt)("li",{parentName:"ol"},'Click "Manage Profiles"')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image119.png")}),(0,r.kt)("ol",{start:16},(0,r.kt)("li",{parentName:"ol"},'Ensure the "API Only" profile is selected:')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image120.png")}),(0,r.kt)("ol",{start:17},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save" at the bottom of the page')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to Setup ",">"," Manage Users ",">"," Users")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "New User"'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image121.png")}),(0,r.kt)("ol",{start:20},(0,r.kt)("li",{parentName:"ol"},"Set necessary fields: Last Name, Alias, Email, Username, Nickname")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image122.png")}),(0,r.kt)("ol",{start:21},(0,r.kt)("li",{parentName:"ol"},"On the right-hand side, set the User License and Profile")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image123.png")}),(0,r.kt)("ol",{start:22},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Save"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In ",(0,r.kt)("strong",{parentName:"p"},"Quick Find"),', search for "Permission Sets". Select the ',(0,r.kt)("strong",{parentName:"p"},"AC_Administrator")," permission set."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/lambda-install-0.png")}),(0,r.kt)("ol",{start:24},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Manage Assignments"),". Add the apiuser you just created to the permission set.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"A confirmation email will be sent, with an activation link. Click the link to activate your user."))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image124.png")}),(0,r.kt)("p",null,"Change (set) a password for apiuser (Considered a strong that contains\nat least 20 random characters):"),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image125.png")}),(0,r.kt)("ol",{start:26},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Click "Change Password"')),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},'Access the apiuser personal settings by selecting the username in the top right corner, then "My Settings".'))),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image126.png")}),(0,r.kt)("ol",{start:28},(0,r.kt)("li",{parentName:"ol"},'Type "Security Token" in the Quick Find box and click "Reset My Security Token".')),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image127.png")}),(0,r.kt)("ol",{start:29},(0,r.kt)("li",{parentName:"ol"},"Your security token will be emailed to you")),(0,r.kt)("img",{src:(0,i.Z)("/img/classic/image128.png")}),(0,r.kt)("ol",{start:30},(0,r.kt)("li",{parentName:"ol"},'Copy the security token from the email in to your installation notes for the "Access Token" value.')),(0,r.kt)("h3",{id:"allowing-the-api-user-to-authenticate-using-password"},"Allowing the API user to authenticate using password"),(0,r.kt)("p",null,"The api user created above authenticates using username-password flow in Salesforce. This flow needs to be unblocked and to do that, go to ",(0,r.kt)("em",{parentName:"p"},"Setup")," and in the Quick Find box, search for ",(0,r.kt)("strong",{parentName:"p"},"OAuth and OpenID Connect Settings"),". After that, make sure that the toggles for ",(0,r.kt)("strong",{parentName:"p"},"Allow OAuth Username-Password Flows")," and ",(0,r.kt)("strong",{parentName:"p"},"Allow OAuth User-Agent Flows")," are turned ON, as shown in below image."),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image292.png")}),(0,r.kt)("h3",{id:"setting-up-the-secretsmanager-secret"},"Setting up the SecretsManager Secret"),(0,r.kt)("p",null,"To ensure that your Salesforce credentials are secure, the Lambdas\nrequire that the credentials are stored in AWS Secrets Manager. AWS\nSecrets Manager is a highly secure service that helps you store and\nretrieve secrets."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"In a new browser tab, login to the AWS console")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure you are in the same region as your Amazon Connect\ninstance. You can set the region by expanding the region selector in\nthe upper right and choosing the region"))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image75.png")}),(0,r.kt)("ol",{start:3},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate to the ",(0,r.kt)("a",{parentName:"p",href:"https://console.aws.amazon.com/secretsmanager/home"},"Secrets Manager\nconsole"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Secrets"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Store a new secret"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Other types of secrets"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure ",(0,r.kt)("strong",{parentName:"p"},"Secret key/value")," is selected")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Enter key value pairs that match the following:"),(0,r.kt)("p",{parentName:"li"},"a.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," Password, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the password for the API user that\nyou configured in the previous section"),(0,r.kt)("p",{parentName:"li"},"b.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," ConsumerKey, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the Consumer Key for the\nConnected App you created in the previous section"),(0,r.kt)("p",{parentName:"li"},"c.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," ConsumerSecret, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," the Consumer Secret for the\nConnected App you created in the previous section"),(0,r.kt)("p",{parentName:"li"},"d.  ",(0,r.kt)("strong",{parentName:"p"},"Key:")," AccessToken, ",(0,r.kt)("strong",{parentName:"p"},"Value:")," this is the access token for\nthe API user that you configured in the previous section")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"For the encryption key, click ",(0,r.kt)("strong",{parentName:"p"},"Add new key"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select ",(0,r.kt)("strong",{parentName:"p"},"Create Key"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure key type is set to ",(0,r.kt)("strong",{parentName:"p"},"symmetric"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Give your key an ",(0,r.kt)("strong",{parentName:"p"},"alias"),", like\n",(0,r.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select administrators you want to have access permission to change\nthe key policy. Make sure you are being as restrictive as possible")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the users and roles you want to have access to the Salesforce\ncredentials in Secrets Manager. Make sure you are being as\nrestrictive as possible")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Finish")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click on the managed key that you just created (which is\n",(0,r.kt)("em",{parentName:"p"},"SalesforceCredentialsSecretsManagerKey")," in this case).")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Note down the ARN. This is SalesforceCredentialsKMSKeyARN that will\nbe used later when installing the Amazon Connect Salesforce Lambda\npackage.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Navigate back to the Secrets Manager setup tab")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the key you just created"))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image76.png")}),(0,r.kt)("ol",{start:23},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Give your secret a name, like ",(0,r.kt)("em",{parentName:"p"},"SalesforceCredentials"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Make sure ",(0,r.kt)("strong",{parentName:"p"},"automatic rotation")," is disabled.")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Next")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Click Store")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},"Select the secret you just created, and copy the Secret ARN"))),(0,r.kt)("img",{src:(0,i.Z)("/img/lightning/image77.png")}))}g.isMDXComponent=!0}}]);