<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-lightning/cti-adapter/03-cti-flows">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">CTI Flow | Amazon Connect Salesforce CTI Adapter</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="CTI Flow | Amazon Connect Salesforce CTI Adapter"><meta data-rh="true" name="description" content="The CTI Adapter provides a mechanism to customize the behavior of the"><meta data-rh="true" property="og:description" content="The CTI Adapter provides a mechanism to customize the behavior of the"><link data-rh="true" rel="icon" href="/amazon-connect-salesforce-cti/img/favicon.png"><link data-rh="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows"><link data-rh="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows" hreflang="en"><link data-rh="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UE7MTAXIA1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Amazon Connect Salesforce CTI Adapter" href="/amazon-connect-salesforce-cti/opensearch.xml"><link rel="stylesheet" href="/amazon-connect-salesforce-cti/assets/css/styles.9a505dc2.css">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/runtime~main.9d61f365.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/main.863d49bc.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><div class="navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">v5.22.0</b></a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Notices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/release-notes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/introduction/01-key-benefits">Key Benefits and Requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Installation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation">Installing the CTI Adapter and Salesforce Lambdas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/02-guided-setup">Setting Up The CTI Adapter Using Guided Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/03-managed-package-manual-setup">Setting Up The CTI Adapter Managed Package Manually</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup">Setting Up The Salesforce Lambdas Manually</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/05-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/06-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">CTI Adapter</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/01-cti-adapter-configuration">CTI Adapter Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/02-cti-attributes">CTI Attributes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows">CTI Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/04-presence-sync-rules">Presence Sync Rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/05-localization">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/06-set-agent-status-on-session-end">Set Agent Status on Session End</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens">Contact Lens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/08-cti-actions">CTI Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/09-recording-controls">Recording Controls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/10-voicemail-drops">Voicemail Drops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/11-chat-widget-integration">Chat Widget Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/12-amazonq-integration">Amazon Q Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/13-voice-id">Voice Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/14-medialess">Setting up Medialess</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Salesforce Lambdas</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/01-contact-flow-salesforce-lambdas">Accessing the Salesforce API from Amazon Connect Contact Flows Using AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/02-historical-metrics">Amazon Connect Historical Metrics in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/03-real-time-metrics">Amazon Connect Real-Time Metrics in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/04-contact-channel-analytics">Contact Channel Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/05-contact-trace-record-import">Contact Trace Record Import</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/06-postcall-contact-lens-import">Postcall Contact Lens Import</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Appendices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0">Appendix A: Required Salesforce Configurations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/01-configuring-my-domain">Configuring My Domain in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/02-configure-salesforce-omnichannel">Configure Salesforce Omnichannel for Testing</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuration">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-c-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix C: CTI Flow Sources and Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-d-cti-flow-examples/01-cti-flow-examples">Appendix D: CTI Flow Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-e-salesforce-high-velocity-sales/01-high-velocity-sales">Appendix E: Integration with Salesforce High Velocity Sales</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-f-cti-flow-blocks/01-cti-flow-blocks">Appendix F: CTI Flow Blocks</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/amazon-connect-salesforce-cti/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">CTI Adapter</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">CTI Flow</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>CTI Flow</h1></header><p>The CTI Adapter provides a mechanism to customize the behavior of the
adapter based on your business needs without needing to edit the
underlying Visualforce pages, which could negatively impact overall
adapter function. This is accomplished through CTI Flows.</p><p>A CTI Flow consist of &quot;actions&quot; that represent an API call to parts of
Salesforce or Amazon Connect API. Like a JavaScript function, each
action can take inputs and provide outputs, or returns values, that you
can use from other actions.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="create-cti-flow">Create CTI Flow<a class="hash-link" href="#create-cti-flow" title="Direct link to heading">​</a></h2><p>To create a new CTI Flow, log in into your Salesforce org and go to the
<strong>Service Console.</strong> Expand the <strong>navigation menu</strong> by selecting the
down arrow and choose <strong>AC CTI Adapters</strong>.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image114.png" class="img_ev3q"><p>Select <strong>ACLightningAdapter.</strong> Scroll down to the <strong>CTI Flows</strong> section
and select New to create a new CTI Script.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image133.png" class="img_ev3q"><p>Provide a user-friendly name in the <strong>CTI Flow Name</strong> field. And click
<strong>Save</strong>.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image134.png" class="img_ev3q"><p>This will take you to a form where you can fill in name and adapter of
the CTI Flow. There are a couple of fields that you may be unfamiliar
with: <strong>Source</strong> and <strong>Event</strong>.</p><p>Let&#x27;s look at <strong>Source</strong> field first.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image135.png" class="img_ev3q"><p>You can think of Source as the &quot;origin&quot; of the CTI Flow. There are
currently 7 sources: Initialization, an Agent on Connect, Voice Contact
on Connect, Queue Callback Contact on Connect, Chat on Connect,
Salesforce Agent or Salesforce UI.</p><p>Each source comes with a set of events that you can hook into, i.e. your
CTI Flow will be executed when one of these events fire. Typically, you
will have only one flow for a combination of a source and an event. (You
can find out more about sources and events in <a href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-c-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix C - CTI Flow Sources and Events</a>.)</p><p>For the purposes of this example, we selected <strong>Amazon Connect Voice
Contact</strong> source and <strong>onConnecting</strong> event. Now click Save and on the
next page scroll down till you find the <strong>CTI Flow</strong> section.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image136.png" class="img_ev3q"><p>Let&#x27;s build a CTI Flow that opens a screenpop in Salesforce when a voice
call comes.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image137.png" class="img_ev3q"><p>You can start using by dragging the item called <strong>CTI Block</strong> from the sidebar in the Main Menu over the stage,
which is marked by a grid pattern.</p><p>When you drop the block, you will see a modal titled <strong>Explorer</strong>. This
modal contains a list of actions you can choose from.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image138.png" class="img_ev3q"><p>In the <strong>Search</strong> field, search for <strong>Phone</strong> and Select the action
called <strong>Get Customer Phone Number</strong> from the results on the right.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image139.png" class="img_ev3q">You should now see a block on the stage for the action you selected, and the sidebar will display some information about this action, including its return value.<p>(Note: If you&#x27;d like to change the label of the action, doubleclick on
it. This will open a text editor. Make your changes and when you&#x27;re
finished click outside the node to save your label.)</p><p>Some actions can be configured using input fields to provide arguments
to function calls, as well. This action does not have any input fields,
and returns two values ---- <strong>phone</strong> and <strong>country</strong>.</p><p>Now let&#x27;s drag another CTI Block over the stage and find an action
called <strong>Search and Screenpop</strong>.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image140.png" class="img_ev3q"><p>Connect these blocks by clicking the green socket (green means &quot;done&quot;)
on <strong>Get Customer Phone</strong>, which will display a blue line that tracks
your mouse cursor around the stage.</p><p>Now, click on the pink socket, i.e. the <strong>input</strong> socket, which is to
the left of the <strong>Search and Screenpop</strong> block. If the connection is
successful, the sockets fill turn into a solid color and the blue line
will connect them. (There are some restrictions on which sockets you can
connect together. For example, you cannot connect output of an action to
its own input socket or connect two inputs.) If you are not happy with
this connection, you can hover over it and double click to remove.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image141.png" class="img_ev3q"><p>Now we&#x27;d like to get the phone number of the customer and use it in
<strong>Search and Screenpop</strong>. Here is a tip: if two actions are connected,
you can use the return values of the first action in the input fields of
the next action. (You can even use the return values of actions
connected to the last action, and the ones connected to that, and so
on.)</p><p>This action has only two options, and we want to use the one called
&quot;phone&quot; for this field.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image142.png" class="img_ev3q"><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image143.png" class="img_ev3q">If you want to enter a custom input value, you can type that, and select **Add New Value** from the dropdown.<p>And make sure to set <strong>callType</strong> to &quot;inbound.&quot; Finally, add the
<strong>Start</strong> and <strong>End</strong> nodes and connect everything together.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image144.png" class="img_ev3q"><p>When you&#x27;re finished, click <strong>Save</strong> in the sidebar. That&#x27;s it. You
created your first CTI Flow.</p><p>To test your flow, go to your <strong>Service Console</strong>, and make a call from
a number that is in the profile of a Contact. As the call is displayed
in your CCP dashboard, Salesforce will pop open the contact of the
caller in a separate tab.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-cti-flow-block-values">Accessing CTI Flow Block Values<a class="hash-link" href="#accessing-cti-flow-block-values" title="Direct link to heading">​</a></h2><p>Internally, CTI flows are organized as JavaScript Object Notation (JSON) objects, and access to them is facilitated through JSON Paths.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="json-paths">JSON Paths<a class="hash-link" href="#json-paths" title="Direct link to heading">​</a></h3><p>JSON paths help you find specific data within a JSON structure, similar to giving directions to locate hidden treasure on a map.</p><p>Basic Syntax:</p><ul><li>Use dot notation (.) to traverse through object properties.</li><li>Use square brackets ([]) to index into arrays.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-object-properties">Accessing Object Properties<a class="hash-link" href="#accessing-object-properties" title="Direct link to heading">​</a></h3><p>Consider this JSON object below:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;name&quot;: &quot;John&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;age&quot;: 25,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;address&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;city&quot;: &quot;New York&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">    &quot;zip&quot;: &quot;10001&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To retrieve the value of the &quot;name&quot; field in this JSON object, you would utilize <code>$.name</code>. The same approach applies to accessing the value of &quot;age&quot; through <code>$.age</code>. If you wish to access the &quot;city&quot; value, you would use <code>$.address.city</code>.</p><p>Consider this next JSON Object:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">  &quot;fruits&quot;: [&quot;apple&quot;, &quot;orange&quot;, &quot;banana&quot;]</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To access the different fruits, you should use the following format: <code>$.fruits[0]</code> or <code>$.fruits[2]</code>. It&#x27;s important to note that the first element (apple) is accessed with &quot;0&quot; rather than &quot;1&quot; due to arrays starting their indexing from 0.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="accessing-cti-flow-object-properties">Accessing CTI Flow Object Properties<a class="hash-link" href="#accessing-cti-flow-object-properties" title="Direct link to heading">​</a></h3><p>Having covered the fundamental concepts of accessing JSON objects, here is an illustration of a CTI flow JSON:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">LogUtils.ts:41 [CTI ADAPTER]: [FLOW] [AC_clickToDialFlow]: actions: {&quot;uid-0&quot;:{&quot;success&quot;:true,&quot;results&quot;:null,&quot;exception&quot;:null},&quot;uid-39&quot;:{&quot;success&quot;:true,&quot;results&quot;:{&quot;value&quot;:{&quot;number&quot;:&quot;+12345678900&quot;}},&quot;exception&quot;:null},&quot;uid-29&quot;:{&quot;success&quot;:true,&quot;results&quot;:true,&quot;exception&quot;:null},&quot;uid-16&quot;:{&quot;success&quot;:true,&quot;results&quot;:{&quot;value&quot;:&quot;+12345678900&quot;},&quot;exception&quot;:null},&quot;uid-54&quot;:{&quot;success&quot;:true,&quot;results&quot;:{&quot;endpointARN&quot;:null,&quot;endpointId&quot;:null,&quot;type&quot;:&quot;phone_number&quot;,&quot;name&quot;:null,&quot;phoneNumber&quot;:&quot;+12345678900&quot;,&quot;agentLogin&quot;:null,&quot;queue&quot;:null},&quot;exception&quot;:null},&quot;uid-44&quot;:{&quot;success&quot;:true,&quot;results&quot;:null,&quot;exception&quot;:null},&quot;uid-18&quot;:{&quot;success&quot;:true,&quot;exception&quot;:null}, uid-17&quot;:{“success”:true,“results”:{“value”:{“type”:“Task”,“Id”:null,“CustomField__c”:“RandomMessage”}, &quot;uid-20&quot;:{&quot;success&quot;:true,&quot;results&quot;:null,&quot;exception&quot;:null}}}}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>It is presented in this format typically, but for this demo, it will be more convenient to conceptualize it like this (condensed for brevity):</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#bfc7d5;--prism-background-color:#292d3e"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#bfc7d5"><span class="token plain">{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   &quot;actions&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uid-39&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;success&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;results&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;value&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;number&quot;:&quot;+12345678900“</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;exception&quot;:null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uid-29&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;success&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;results&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;exception&quot;:null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uid-54&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;success&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;results&quot;:{</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;endpointARN&quot;:null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;endpointId&quot;:null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;type&quot;:&quot;phone_number&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;name&quot;:null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;phoneNumber&quot;:&quot;+12345678900&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;agentLogin&quot;:null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;queue&quot;:null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;exception&quot;:null</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      &quot;uid-17&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;success&quot;:true,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">         &quot;results&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;value&quot;: {</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;type&quot;:&quot;Task&quot;,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;Id&quot;:null,</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">               &quot;CustomField__c&quot;:&quot;RandomMessage&quot;</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">            },</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">   }</span><br></span><span class="token-line" style="color:#bfc7d5"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Similar to the approach used for accessing values in smaller JSON objects, you can apply the same methodology here. To retrieve the phone number in the CTI flow block with &quot;uid-54,&quot; you can use the following syntax: <code>$.actions.uid-54.results.phoneNumber</code>.</p><p>For certain CTI flow blocks, the return values can be more intricate. Take, for instance, the CTI flow block with &quot;uid-17,&quot; which generates a Task record in Salesforce. To access the values <code>type</code>, <code>Id</code>, or <code>CustomField__c</code>, you need to use the format: <code>$.actions.uid-17.results.value.[0].CustomField__c</code>. The use of &quot;<!-- -->[0]<!-- -->&quot; is essential in this case, as the particular CTI flow block can return multiple Task objects stored as an array.</p><p>Note: It&#x27;s crucial to verify the return values of a CTI flow object before attempting to access its value, as not every CTI flow block returns a value. Otherwise, you may receive <code>undefined</code>, indicating the requested value does not exist.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-would-i-use-this">Why Would I Use This?<a class="hash-link" href="#why-would-i-use-this" title="Direct link to heading">​</a></h3><p>In most instances, direct access to CTI flow values is unnecessary, as return values are selectable through a dropdown menu in the CTI flow block. </p><p>However, for scenarios where the dropdown menu is inaccessible, such as with CTI flow blocks like &quot;Send Data to CCP Overlay,&quot; accessing the value directly becomes more practical.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/JSONAccess1.png" class="img_ev3q"><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/JSONAccess2.png" class="img_ev3q"></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/03-cti-adapter/03-cti-flows.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/02-cti-attributes"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">CTI Attributes</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/04-presence-sync-rules"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Presence Sync Rules</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#create-cti-flow" class="table-of-contents__link toc-highlight">Create CTI Flow</a></li><li><a href="#accessing-cti-flow-block-values" class="table-of-contents__link toc-highlight">Accessing CTI Flow Block Values</a><ul><li><a href="#json-paths" class="table-of-contents__link toc-highlight">JSON Paths</a></li><li><a href="#accessing-object-properties" class="table-of-contents__link toc-highlight">Accessing Object Properties</a></li><li><a href="#accessing-cti-flow-object-properties" class="table-of-contents__link toc-highlight">Accessing CTI Flow Object Properties</a></li><li><a href="#why-would-i-use-this" class="table-of-contents__link toc-highlight">Why Would I Use This?</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/amazon-connect-salesforce-cti/assets/js/runtime~main.9d61f365.js"></script>
<script src="/amazon-connect-salesforce-cti/assets/js/main.863d49bc.js"></script>
</body>
</html>