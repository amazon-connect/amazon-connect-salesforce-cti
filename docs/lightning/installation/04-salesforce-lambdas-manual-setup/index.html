<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-lightning/installation/04-salesforce-lambdas-manual-setup">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.1.0">
<title data-rh="true">Setting Up The Salesforce Lambdas Manually | Amazon Connect Salesforce CTI Adapter</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Setting Up The Salesforce Lambdas Manually | Amazon Connect Salesforce CTI Adapter"><meta data-rh="true" name="description" content="Below are manual setup instructions for the Salesforce Lambdas."><meta data-rh="true" property="og:description" content="Below are manual setup instructions for the Salesforce Lambdas."><link data-rh="true" rel="icon" href="/amazon-connect-salesforce-cti/img/favicon.png"><link data-rh="true" rel="canonical" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup"><link data-rh="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup" hreflang="en"><link data-rh="true" rel="alternate" href="https://amazon-connect.github.io/amazon-connect-salesforce-cti//amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://UE7MTAXIA1-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="Amazon Connect Salesforce CTI Adapter" href="/amazon-connect-salesforce-cti/opensearch.xml"><link rel="stylesheet" href="/amazon-connect-salesforce-cti/assets/css/styles.9a505dc2.css">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/runtime~main.ac9cd61b.js" as="script">
<link rel="preload" href="/amazon-connect-salesforce-cti/assets/js/main.825280b4.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="theme.common.skipToMainContent"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/amazon-connect-salesforce-cti/"><div class="navbar__logo"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="" class="themedImage_ToTc themedImage--light_HNdA"><img src="/amazon-connect-salesforce-cti/img/logo.svg" alt="" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">v5.23.3</b></a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Lightning</a><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/classic/notices">Classic</a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/amazon-connect-salesforce-cti/docs/other/earlier-versions">Earlier Versions</a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/tree/main/pdf" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">PDF<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/notices">Notices</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/release-notes">Release Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/amazon-connect-salesforce-cti/docs/lightning/introduction/01-key-benefits">Key Benefits and Requirements</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active">Installation</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/01-installation">Installing the CTI Adapter and Salesforce Lambdas</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/02-guided-setup">Setting Up The CTI Adapter Using Guided Setup</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/03-managed-package-manual-setup">Setting Up The CTI Adapter Managed Package Manually</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/04-salesforce-lambdas-manual-setup">Setting Up The Salesforce Lambdas Manually</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/05-upgrading-from-an-earlier-version">Upgrading from an Earlier Version</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/installation/06-adapter-installation-troubleshooting">CTI Adapter Installation Troubleshooting and Common Issues</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">CTI Adapter</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/01-cti-adapter-configuration">CTI Adapter Configuration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/02-cti-attributes">CTI Attributes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/03-cti-flows">CTI Flow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/04-presence-sync-rules">Presence Sync Rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/05-localization">Localization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/06-set-agent-status-on-session-end">Set Agent Status on Session End</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/07-contact-lens">Contact Lens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/08-cti-actions">CTI Actions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/09-recording-controls">Recording Controls</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/10-voicemail-drops">Voicemail Drops</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/11-chat-widget-integration">Chat Widget Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/12-amazonq-integration">Amazon Q Integration</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/13-voice-id">Voice Id</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/cti-adapter/14-medialess">Setting up Medialess</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Salesforce Lambdas</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/01-contact-flow-salesforce-lambdas">Accessing the Salesforce API from Amazon Connect Contact Flows Using AWS Lambda</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/02-historical-metrics">Amazon Connect Historical Metrics in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/03-real-time-metrics">Amazon Connect Real-Time Metrics in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/04-contact-channel-analytics">Contact Channel Analytics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/05-contact-trace-record-import">Contact Trace Record Import</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/salesforce-lambdas/06-postcall-contact-lens-import">Postcall Contact Lens Import</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link">Appendices</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link" tabindex="0">Appendix A: Required Salesforce Configurations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/01-configuring-my-domain">Configuring My Domain in Salesforce</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-a-required-salesforce-configurations/02-configure-salesforce-omnichannel">Configure Salesforce Omnichannel for Testing</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-b-configuring-salesforce-as-your-identity-provider/01-configuration">Appendix B: Configuring Salesforce as Your Identity Provider</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-c-cti-flow-sources-and-events/01-cti-flow-sources-and-events">Appendix C: CTI Flow Sources and Events</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-d-cti-flow-examples/01-cti-flow-examples">Appendix D: CTI Flow Examples</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-e-salesforce-high-velocity-sales/01-high-velocity-sales">Appendix E: Integration with Salesforce High Velocity Sales</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/amazon-connect-salesforce-cti/docs/lightning/appendices/appendix-f-cti-flow-blocks/01-cti-flow-blocks">Appendix F: CTI Flow Blocks</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/amazon-connect-salesforce-cti/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Installation</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Setting Up The Salesforce Lambdas Manually</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Setting Up The Salesforce Lambdas Manually</h1></header><p>Below are manual setup instructions for the Salesforce Lambdas.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisite-configuration-and-data-collection">Prerequisite Configuration and Data Collection<a class="hash-link" href="#prerequisite-configuration-and-data-collection" title="Direct link to heading">​</a></h3><p>In order to successfully deploy and utilize the functions in the Amazon
Connect Salesforce Lambda package, you will need to validate and
configure some items in your Salesforce Org and gather some information
from your Amazon Connect instance.</p><ul><li><p>Check your Salesforce API version</p></li><li><p>Create a new Connected App</p></li><li><p>Create a new API user</p></li><li><p>Gather Amazon Connect information</p></li></ul><p>As you are preparing to deploy the package, it is a good idea to open a
text editor and note information as you configure the environment. We
will point out the items you will need to provide.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="check-your-salesforce-api-version">Check your Salesforce API Version<a class="hash-link" href="#check-your-salesforce-api-version" title="Direct link to heading">​</a></h3><ol><li><p>Log in into your Salesforce org and go to <strong>Setup</strong></p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>apex</strong>, then select <strong>Apex
Classes</strong> from the results</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image56.png" class="img_ev3q"><ol start="3"><li>Select New</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image57.png" class="img_ev3q"><ol start="4"><li>Select the Version Settings tab</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image58.png" class="img_ev3q"><ol start="5"><li>Note the Salesforce.com API version in your notepad. The pattern of this value is <code>vXX.X</code>.</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image59.png" class="img_ev3q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-connected-app">Create a New Connected App<a class="hash-link" href="#create-a-new-connected-app" title="Direct link to heading">​</a></h4><p>To leverage the full potential of the integration, Salesforce data needs
to be accessed from AWS environment. The package comes with a set of
pre-built AWS Lambda functions to lookup, update and create Salesforce
objects within Amazon Connect Contact Flows. These Lambda function
access Salesforce using the Salesforce REST API.</p><p>To get access to the environment, a Connected App must be configured
with OAuth settings enabled.</p><ol><li><p>Log in into your Salesforce org and go to <strong>Setup</strong></p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>app manager</strong>, then select <strong>App
Manager</strong> from the results</p></li><li><p>In the upper right corner, select <strong>New Connected App</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image60.png" class="img_ev3q"><ol start="4"><li>On the New Connected App form, enter a name for the Connected App,
such as <strong>Amazon Connect Integration</strong> and press tab. This will
populate the API Name automatically. Then provide a contact email
address</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image61.png" class="img_ev3q"><ol start="5"><li>Select the checkbox to <strong>Enable OAuth Settings</strong></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image62.png" class="img_ev3q"><ol start="6"><li>Set the <strong>Callback URL</strong> to your domain url. Find the domain at <em>Setup</em> -&gt; <em>My Domain</em>.</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image293.png" class="img_ev3q"><ol start="7"><li><p>In the Selected OAuth Scopes section, select the following and add
them to the Selected OAuth Scopes:</p></li><li><p>Access the identity URL service (id, profile, email, address, phone)</p></li><li><p>Manage user data via APIs (api)</p></li><li><p>Select the checkbox for Require Secret for Web Server Flow, and the checkbox for Require Secret For Refresh Token Flow</p></li><li><p>The <strong>API (Enable OAuth Settings)</strong> section should now look like
this</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/guidedsetup4.png" class="img_ev3q"><ol start="12"><li><p>Select <strong>Save</strong> at the bottom of the screen.</p></li><li><p>Select <strong>Continue</strong> on the New Connected App page</p></li><li><p>You should now be at the new app&#x27;s page</p></li><li><p>Copy the value for <strong>Consumer Key</strong> to your notepad</p></li><li><p>Select <strong>Click to reveal</strong> next to Consumer Secret and copy the
value to your notepad</p></li><li><p>At the top of the detail page, select <strong>Manage</strong></p></li><li><p>On the Connected App Detail page, select the <strong>Edit Policies</strong>
button</p></li><li><p>Set Permitted Users to <strong>Admin approved users are pre-authorized</strong>
and choose OK on the pop-up dialog</p></li><li><p>Set IP Relaxation to <strong>Relax IP restrictions</strong></p></li><li><p>The OAuth Policies section should now look like the following</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image65.png" class="img_ev3q"><ol start="22"><li>Select <strong>Save</strong></li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="create-a-new-api-user">Create a new API user<a class="hash-link" href="#create-a-new-api-user" title="Direct link to heading">​</a></h3><p>The Lambda functions authenticate with Salesforce via user credentials.
It is a common practice to create an API user account for this purpose.</p><ol><li><p>Log in into your Salesforce org and go to <strong>Setup</strong></p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>profiles</strong>, then select
<strong>Profiles</strong> from the results</p></li><li><p>Select New Profile</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image66.png" class="img_ev3q"><ol start="4"><li><p>Provide a Profile Name, such as <strong>API_ONLY</strong></p></li><li><p>From the <strong>Existing Profile</strong> dropdown, select <strong>System Administrator</strong>
<strong>NOTE:</strong> You\&#x27;re advised to use a full Salesforce License for the
user to be able to set the below permissions and have full access to
avoid any other errors.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image67.png" class="img_ev3q"><ol start="6"><li><p>Select <strong>Save</strong> to create the new profile</p></li><li><p>Once the new profile page opens, scroll down to and select the <strong>System Permissions</strong> section</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/usersetup1.png" class="img_ev3q"><ol start="8"><li><p>When the next page opens, select <strong>edit</strong></p></li><li><p>Make sure the <strong>Lightning Experience User</strong> option is unselected</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image290.png" class="img_ev3q"><ol start="10"><li><p>Select <strong>Save</strong>, and confirm the changes</p></li><li><p>Go back to the Profile Overview, scroll down, and select <strong>Password Policies</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/usersetup2.png" class="img_ev3q"><ol start="12"><li><p>Select <strong>Edit</strong>.</p></li><li><p>Set <strong>User passwords expire in</strong> to <strong>Never expires</strong> NOTE: Failure to this may lead to production outages.</p></li><li><p>Select <strong>Save</strong>.</p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>connect</strong>, then select <strong>Manage
Connected Apps</strong> from the results</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image69.png" class="img_ev3q"><ol start="16"><li><p>Select the app you have created earlier, <strong>Amazon Connect
Integration</strong></p></li><li><p>In the profiles section, select <strong>Manage Profiles</strong></p></li><li><p>Select the new <strong>API_Only</strong> profile that you just created</p></li><li><p>Select <strong>Save</strong> at the bottom of the page</p></li><li><p>In the <strong>Quick Find</strong> field, type <strong>users</strong> then select <strong>Users</strong>
from the results</p></li><li><p>Select New User</p></li><li><p>Set the required fields as:</p><p>a.  Last Name: apiuser</p><p>b.  Alias: apiuser</p><p>c.  Email: provide a valid email address</p><p>d.  Username: apiuser@&lt;yoursalesforcedomain<!-- -->&gt;<!-- -->.com</p><p>e.  Nickname: apiuser</p></li><li><p>On the right-hand side, set <strong>User License</strong> to <strong>Salesforce</strong></p></li><li><p>Set Profile to API_ONLY</p></li><li><p>Choose <strong>Save</strong></p></li><li><p>In <strong>Quick Find</strong>, search for &quot;Permission Sets&quot;. Select the <strong>AC_Administrator</strong> permission set.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/lambda-install-0.png" class="img_ev3q"><ol start="27"><li><p>Select <strong>Manage Assignments</strong>. Add the apiuser you just created to the permission set.</p></li><li><p>A confirmation email with an <strong>activation link</strong> will be sent to the
email address provided. Choose the link to activate your user and
set their password</p></li><li><p>Fill out the form to set a password for the API user</p></li><li><p>Select <strong>Change Password</strong>. The API user will log into the
Salesforce Classic view</p></li><li><p>Access the API user&#x27;s personal settings by selecting the username in
the top right corner, then choose <strong>My Settings</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image70.png" class="img_ev3q"><ol start="32"><li>In the <strong>Quick Find</strong> field, type <strong>security</strong> then select <strong>Reset
My Security Token</strong> from the results</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image71.png" class="img_ev3q"><ol start="33"><li><p>Select <strong>Reset Security Token</strong>. Your security token will be emailed
to you</p></li><li><p>Copy the security token from the email to your notepad</p></li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="allowing-the-api-user-to-authenticate-using-password">Allowing the API user to authenticate using password<a class="hash-link" href="#allowing-the-api-user-to-authenticate-using-password" title="Direct link to heading">​</a></h4><p>The api user created above authenticates using username-password flow in Salesforce. This flow needs to be unblocked and to do that, go to <em>Setup</em> and in the Quick Find box, search for <strong>OAuth and OpenID Connect Settings</strong>. After that, make sure that the toggles for <strong>Allow OAuth Username-Password Flows</strong> and <strong>Allow OAuth User-Agent Flows</strong> are turned ON, as shown in below image.</p><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image292.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gather-amazon-connect-information">Gather Amazon Connect information<a class="hash-link" href="#gather-amazon-connect-information" title="Direct link to heading">​</a></h3><p>The last thing to do before you can install the Amazon Connect
Salesforce Lambda Package is gather some details about your Amazon
Connect instance. These will be used during the package installation.</p><ol><li><p>In a new browser tab, login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer"><strong>AWS
console</strong></a></p></li><li><p>Navigate to the <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon Connect
Console</a></p></li><li><p>Select your Instance Alias</p></li><li><p>On the Overview page for your instance, copy the string following
instance/ in the Instance ARN and paste it to your notepad. This is
your Instance ID.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/image05.png" class="img_ev3q"><ol start="5"><li><p>In the left nav, select <strong>Data storage</strong></p></li><li><p>On the <strong>Data storage</strong> page, copy the S3 bucket names for your Call
recordings and Exported Reports. The bucket name is everything
preceding the first / in the XX will be stored here sections</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/image06.png" class="img_ev3q"><ol start="7"><li><p>In the left nav, select <strong>Data streaming</strong></p></li><li><p>Note the name of the Kinesis stream configured in the Contact Trace
Records section, then select <strong>Create a new Kinesis Stream</strong>. This
will take you to the list of Kinesis streams configured in this
region.</p></li><li><p>Select the <strong>Kinesis stream name</strong> that matches what was configured
in the previous step</p></li><li><p>On the stream detail page, copy the entire value for Stream ARN</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image74.png" class="img_ev3q"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="store-salesforce-credentials-in-aws-secrets-manager">Store Salesforce Credentials in AWS Secrets Manager<a class="hash-link" href="#store-salesforce-credentials-in-aws-secrets-manager" title="Direct link to heading">​</a></h4><p>To ensure that your Salesforce credentials are secure, the Lambdas
require that the credentials are stored in AWS Secrets Manager. AWS
Secrets Manager is a highly secure service that helps you store and
retrieve secrets.</p><ol><li><p>In a new browser tab, login to the AWS console</p></li><li><p>Make sure you are in the same region as your Amazon Connect
instance. You can set the region by expanding the region selector in
the upper right and choosing the region</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image75.png" class="img_ev3q"><ol start="3"><li><p>Navigate to the <a href="https://console.aws.amazon.com/secretsmanager/home" target="_blank" rel="noopener noreferrer">Secrets Manager
console</a></p></li><li><p>Select <strong>Secrets</strong></p></li><li><p>Select <strong>Store a new secret</strong></p></li><li><p>Select <strong>Other types of secrets</strong></p></li><li><p>Make sure <strong>Secret key/value</strong> is selected</p></li><li><p>Enter key value pairs that match the following:</p><p>a.  <strong>Key:</strong> Password, <strong>Value:</strong> the password for the API user that
you configured in the previous section</p><p>b.  <strong>Key:</strong> ConsumerKey, <strong>Value:</strong> the Consumer Key for the
Connected App you created in the previous section</p><p>c.  <strong>Key:</strong> ConsumerSecret, <strong>Value:</strong> the Consumer Secret for the
Connected App you created in the previous section</p><p>d.  <strong>Key:</strong> AccessToken, <strong>Value:</strong> this is the access token for
the API user that you configured in the previous section</p></li><li><p>For the encryption key, click <strong>Add new key</strong></p></li><li><p>Select <strong>Create Key</strong></p></li><li><p>Make sure key type is set to <strong>symmetric</strong></p></li><li><p>Give your key an <strong>alias</strong>, like
<em>SalesforceCredentialsSecretsManagerKey</em></p></li><li><p>Click Next</p></li><li><p>Select administrators you want to have access permission to change
the key policy. Make sure you are being as restrictive as possible</p></li><li><p>Click Next</p></li><li><p>Select the users and roles you want to have access to the Salesforce
credentials in Secrets Manager. Make sure you are being as
restrictive as possible</p></li><li><p>Click Next</p></li><li><p>Click Finish</p></li><li><p>Click on the managed key that you just created (which is
<em>SalesforceCredentialsSecretsManagerKey</em> in this case).</p></li><li><p>Note down the ARN. This is SalesforceCredentialsKMSKeyARN that will
be used later when installing the Amazon Connect Salesforce Lambda
package.</p></li><li><p>Navigate back to the Secrets Manager setup tab</p></li><li><p>Select the key you just created</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image76.png" class="img_ev3q"><ol start="23"><li><p>Click Next</p></li><li><p>Give your secret a name, like <em>SalesforceCredentials</em></p></li><li><p>Click Next</p></li><li><p>Make sure <strong>automatic rotation</strong> is disabled.</p></li><li><p>Click Next</p></li><li><p>Click Store</p></li><li><p>Select the secret you just created, and copy the Secret ARN</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image77.png" class="img_ev3q"><ol start="30"><li>You should now have all of the information you need to install the
package</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="install-the-amazon-connect-salesforce-lambda-package">Install the Amazon Connect Salesforce Lambda package<a class="hash-link" href="#install-the-amazon-connect-salesforce-lambda-package" title="Direct link to heading">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="compatibility-table">Compatibility Table<a class="hash-link" href="#compatibility-table" title="Direct link to heading">​</a></h4><p>The following table instructs users on the best CTI Adapter version to
use with the corresponding lambda version. If a minor version for the CTI Adapter is not
listed (ex. v5.21.1), it will be grouped with with its major version unless otherwise specified</p><table><tr><th>CTI Adapter Version</th><th>Lambda Version</th></tr><tr><td>v5.22</td><td>v5.22</td></tr><tr><td>v5.21</td><td>v5.19 - v5.19.7</td></tr><tr><td>v5.20</td><td>v5.19 - v5.19.7</td></tr><tr><td>v5.19</td><td>v5.19 - v5.19.7</td></tr><tr><td>v5.18</td><td>v5.18</td></tr><tr><td>v5.17</td><td>v5.17</td></tr><tr><td>v5.16</td><td>v5.16</td></tr><tr><td>v5.15</td><td>v5.15</td></tr><tr><td>v5.14</td><td>v5.14</td></tr><tr><td>v5.13</td><td>v5.13</td></tr><tr><td>v5.12</td><td>v5.11 - v5.12</td></tr><tr><td>v5.11</td><td>v5.11 - v5.12</td></tr><tr><td>v5.10</td><td>v5.10</td></tr><tr><td>v5.9</td><td>v5.9</td></tr><tr><td>v5.7</td><td>v5.7 - v5.8</td></tr><tr><td>v5.6</td><td>v5.7 - v5.8</td></tr></table><h4 class="anchor anchorWithStickyNavbar_LWe7" id="instructions">Instructions<a class="hash-link" href="#instructions" title="Direct link to heading">​</a></h4><ol><li><p>In a new browser tab, login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer">AWS
console</a></p></li><li><p>Make sure you are in the same region as your Amazon Connect instance</p></li><li><p>Once you have selected the region, navigate to the <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon Connect
Console</a></p></li><li><p>Verify that the Amazon Connect instance that you wish to configure
is listed</p></li><li><p>Once you have verified your Amazon Connect instance, Open the
<a href="https://console.aws.amazon.com/serverlessrepo/home" target="_blank" rel="noopener noreferrer">Serverless Application Repository
Console</a></p></li><li><p>In the left navigation, select <strong>Available Applications</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image78.png" class="img_ev3q"><ol start="7"><li>In the search area, make sure that <strong>Public applications</strong> is
selected, check the box for <strong>Show apps that create custom IAM roles
or resource policies</strong>, and enter <strong>Salesforce</strong> in the search
field, this will automatically filter the available packages</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image79.png" class="img_ev3q"><ol start="8"><li>Select AmazonConnectSalesForceLambda</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image80.png" class="img_ev3q"><ol start="9"><li><p>When the Application loads, scroll down to the <strong>Application
settings</strong> section</p></li><li><p>Fill in the parameters using the data you gathered in your notepad
in the previous section using the following notes:</p><ol><li><p><strong>Application name:</strong> You can accept the default here or change
it as desired</p></li><li><p><strong>AmazonConnectInstanceId:</strong> You Amazon Connect Instance Id.
Only required if you enable real time reporting</p></li><li><p><strong>CTRKinesisARN:</strong> This is the ARN for the Kinesis stream that
was configured for Contact Trace Record streaming in Amazon
Connect. This is the complete ARN. Amazon Kinesis Firehose is
not supported.</p></li><li><p><strong>ConnectReportingS3BucketName:</strong> This is the name of the S3
bucket used to store exported reports for your Amazon Connect
instance. This is ONLY the bucket name, no sub-folders or
suffixes</p></li><li><p><strong>HistoricalReportingImportEnabled:</strong> true <!-- -->|<!-- --> false - if set to
true, the package will include a feature to import Amazon
Connect Queue and Agent Historical Metrics into your Salesforce
Org. This feature requires you to provide
<strong>ConnectReportingS3BucketName</strong></p></li><li><p><strong>LambdaLoggingLevel:</strong> DEBUG <!-- -->|<!-- --> INFO <!-- -->|<!-- --> WARNING <!-- -->|<!-- --> ERROR <!-- -->|<!-- -->
CRITICAL - Logging level for Lambda functions</p></li><li><p><strong>PrivateVpcEnabled:</strong> Set to true if functions should be
deployed to a private VPC. Set VpcSecurityGroupList and
VpcSubnetList if this is set to true.</p></li><li><p><strong>RealtimeReportingImportEnabled:</strong> true <!-- -->|<!-- --> false - if set to
true, the package will include a feature to publish Amazon
Connect Queue Metrics into your Salesforce Org. This feature
requires you to provide <strong>AmazonConnectInstanceId</strong></p></li><li><p><strong>SalesforceAdapterNamespace:</strong> This is the namespace for CTI
Adapter managed package. The default value is <strong>amazonconnect</strong>.
If a non-managed package is used, leave this field blank.</p></li><li><p><strong>SalesforceCredentialsKMSKeyARN:</strong> This is the ARN for KMS
customer managed key that you created in the previous section.</p></li><li><p><strong>SalesforceCredentialsSecretsManagerARN:</strong> This is the ARN for
the Secrets Manager Secret that you created in the previous
section.</p></li><li><p><strong>SalesforceHost:</strong> The full domain for your salesforce org. For
example
<code>https://mydevorg-dev-ed.my.salesforce.com</code>.
Please make sure that the host starts with <code>https</code>, and that the url
ends with <code>.my.salesforce.com</code>. This url can be found in <code>Setup</code> -&gt; <code>My Domain</code>.</p></li><li><p><strong>SalesforceProduction:</strong> true <!-- -->|<!-- --> false - True for Production
Environment, False for Sandbox</p></li><li><p><strong>SalesforceUsername:</strong> The username for the API user that you
configured in the previous section. Salesforce usernames are in the form of an email address.</p></li><li><p><strong>SalesforceVersion:</strong> This is the Salesforce.com API version
that you noted in the previous section. The pattern of this value is <code>vXX.X</code>.</p></li><li><p><strong>TranscribeOutputS3BucketName:</strong> This is the S3 bucket where
Amazon Transcribe stores the output. Typically, this is the same
bucket that call recordings are stored in, so you can use the
same value as found in <strong>ConnectRecordingS3BucketName</strong>. Not
required if PostcallRecordingImportEnabled,
PostcallTranscribeEnabled, ContactLensImportEnabled set to false.</p></li><li><p><strong>VpcSecurityGroupList:</strong> The list of SecurityGroupIds for
Virtual Private Cloud (VPC). Not required if PrivateVpcEnabled
is set to false.</p></li><li><p><strong>VpcSubnetList:</strong> The list of Subnets for the Virtual Private
Cloud (VPC). Not required if PrivateVpcEnabled is set to false.</p></li><li><p><strong>AmazonConnectQueueMaxRecords:</strong> Enter record set size for list
queue query. Max is 100.</p></li><li><p><strong>AmazonConnectQueueMetricsMaxRecords:</strong> Enter record set size
for queue metrics query. Max is 100.</p></li><li><p><strong>CTREventSourceMappingMaximumRetryAttempts:</strong> Maximum retry
attempts on failure for lambdas triggered by Kinesis Events.</p></li><li><p><strong>ConnectRecordingS3BucketName:</strong> This is the name of the S3
bucket used to store recordings for your Amazon Connect
instance. This is ONLY the bucket name, no sub-folders or
suffixes</p></li><li><p><strong>ContactLensImportEnabled:</strong> true <!-- -->|<!-- --> false - Set to false if
importing Contact Lens into Salesforce should not be enabled.</p></li><li><p><strong>PostcallCTRImportEnabled:</strong> true <!-- -->|<!-- --> false - Set to false if
importing CTRs into Salesforce should not be enabled on the
package level. This setting can be disabled on a call-by-call
basis.</p></li><li><p><strong>PostcallRecordingImportEnabled:</strong> true <!-- -->|<!-- --> false - Set to false
if importing call recordings into Salesforce should not be
enabled on the package level. This setting can be disabled on a
call-by-call basis.</p></li><li><p><strong>PostcallTranscribeEnabled:</strong> true <!-- -->|<!-- --> false - Set to false if
post-call transcription should not be enabled on the package
level. This setting can be disabled on a call-by-call basis.</p></li><li><p><strong>TranscriptionJobCheckWaitTime:</strong> Time between transcription
job checks</p></li></ol></li><li><p>Once you have completed the form, select <strong>Deploy</strong></p></li><li><p>Deployment will take some time, with status updates being provided
by the UI. Once it has completely deployed, you will receive a
notification on the screen</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image81.png" class="img_ev3q"><h3 class="anchor anchorWithStickyNavbar_LWe7" id="test-the-core-functionality">Test the Core Functionality<a class="hash-link" href="#test-the-core-functionality" title="Direct link to heading">​</a></h3><p>The package provides a core Lambda function (sfInvokeAPI) that supports
multiple operations, like lookup, create and update. For the initial
validation, sample events are provided within the function. Validating
this function provides a good check that the installation and
configuration is correct.</p><p>Validating the lambda functions requires the use of test events to
simulate data coming into the function as it would in a typical
deployment. Each function has a set of test event samples included to
make validation easier.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="validate-the-core-functionality">Validate the core functionality<a class="hash-link" href="#validate-the-core-functionality" title="Direct link to heading">​</a></h4><ol><li><p>In a new browser tab, login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer"><strong>AWS
console</strong></a></p></li><li><p>Open the <a href="https://console.aws.amazon.com/lambda/home" target="_blank" rel="noopener noreferrer">AWS Lambda
Console</a></p></li><li><p>In the Filter field, enter sfInvokeAPI and press enter, this will
filter your list out to the core function that we just installed</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image82.png" class="img_ev3q"><ol start="4"><li><p>Select the <strong>function name.</strong> First, we will validate a phone number
lookup.</p></li><li><p>In the Environment pane, double-click the event-phoneLookup.json
file</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image83.png" class="img_ev3q"><ol start="6"><li><p>The test even JSON will open in the Lambda editor</p></li><li><p>Modify the value for sf_phone to match the phone number of the test
contact you created when you setup the CTI adapter or for any valid
contact in your Salesforce org\
NOTE: The phone number must be in <a href="https://docs.aws.amazon.com/connect/latest/adminguide/amazon-connect-contact-control-panel.html#international-calls-ccp" target="_blank" rel="noopener noreferrer">E.164
format</a></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image84.png" class="img_ev3q"><ol start="8"><li><p>Select the entire JSON event and copy it, then close the
<strong>event-phoneLookup.json</strong> tab.</p></li><li><p>In the top-right corner, select drop-down arrow next to <strong>Test</strong> and
choose <strong>Configure test events</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image85.png" class="img_ev3q"><ol start="10"><li><p>Select the radio button for <strong>Create new test event</strong> and provide an
event name, for example: <strong>phoneLookup</strong></p></li><li><p>Select the existing event JSON and <strong>delete</strong> it. Paste the modified
JSON payload you copied from the <strong>event-phoneLookup.json</strong> file</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image86.png" class="img_ev3q"><ol start="12"><li><p>Select <strong>Create</strong> to save your test event</p></li><li><p>By default, your new test event should be selected in the drop-down
list to the left of the Test button.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image87.png" class="img_ev3q"><ol start="14"><li><p>Select <strong>Test</strong></p></li><li><p>If successful, the result will contain fields defined in &quot;sf_fields&quot;
parameter in the invocation event</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image88.png" class="img_ev3q"><ol start="16"><li><p>Copy the value for the <strong>Id</strong> key in the response. Next, we are
going to use that Id to create a Case in Salesforce.</p></li><li><p>In the Environment pane, double-click the <strong>event-create.json</strong>
file. Replace the existing ContactId value with the ID value you
copied previously.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image89.png" class="img_ev3q"><ol start="18"><li><p>Select the entire JSON event and copy it, then close the
<strong>event-create.json</strong> tab.</p></li><li><p>In the top-right corner, select drop-down arrow next to <strong>Test</strong> and
choose <strong>Configure test events</strong></p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image90.png" class="img_ev3q"><ol start="20"><li><p>Select the radio button for <strong>Create new test event</strong> and provide an
event name, for example: <strong>createCase</strong></p></li><li><p>Select the existing event JSON and <strong>delete</strong> it. Paste the modified
JSON payload you copied from the <strong>event-create.json</strong> file</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image91.png" class="img_ev3q"><ol start="22"><li><p>Select <strong>Create</strong> to save your test event</p></li><li><p>By default, your new test event should be selected in the drop-down
list to the left of the Test button.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image92.png" class="img_ev3q"><ol start="24"><li><p>Select <strong>Test</strong></p></li><li><p>If successful, the result will contain the Case Id</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image93.png" class="img_ev3q"><ol start="26"><li><p>Copy the value for the <strong>Id</strong> key in the response.</p></li><li><p>When we created the case, the <strong>Status was set to New</strong> and the
<strong>Priority to Low</strong>. We are going to use the update operation to
close the case.</p></li><li><p>In the Environment pane, double-click the <strong>event-update.json</strong> file
and replace the existing Case Id in &quot;sf_id&quot; parameter with the new
one you copied from the last test result</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image94.png" class="img_ev3q"><ol start="29"><li><p>Select the <strong>entire JSON event</strong> and copy it, then close the
<strong>event-update.json</strong> tab.</p></li><li><p>In the top-right corner, select drop-down arrow next to <strong>Test</strong> and
choose **Configure test events</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image95.png" class="img_ev3q"><ol start="31"><li><p>Select the radio button for <strong>Create new test event</strong> and provide an
event name, for example: <strong>updateCase</strong></p></li><li><p>Select the existing event JSON and <strong>delete</strong> it. Paste the modified
JSON payload you copied from the <strong>event-update.json</strong> file</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image96.png" class="img_ev3q"><ol start="33"><li><p>Select <strong>Create</strong> to save your test event</p></li><li><p>By default, your new test event should be selected in the drop-down
list to the left of the Test button.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image97.png" class="img_ev3q"><ol start="35"><li><p>Select <strong>Test</strong></p></li><li><p>If successful, the result will be the <strong>HTTP 204</strong> No Content
success status response code</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image98.png" class="img_ev3q"><ol start="37"><li><p>Log in into your Salesforce org and go to the <strong>Service Console</strong></p></li><li><p>In the search box, change the object type to Cases and type Amazon
Connect Case, then press enter</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image99.png" class="img_ev3q"><ol start="39"><li>You should find 1 case opened by the API user, and the status should
be closed</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/lightning/image100.png" class="img_ev3q"><ol start="40"><li>You have completed core function validation</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="allow-amazon-connect-to-access-the-sfinvokeapi-lambda-function">Allow Amazon Connect to Access the sfInvokeAPI Lambda Function<a class="hash-link" href="#allow-amazon-connect-to-access-the-sfinvokeapi-lambda-function" title="Direct link to heading">​</a></h3><p>Once you have validated function, you can use the Amazon Connect console
to add the sfInvokeAPI Lambda function to your Amazon Connect instance.
This automatically adds resource permissions that allow Amazon Connect
to invoke the function.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="add-the-lambda-function-to-your-amazon-connect-instance">Add the Lambda function to your Amazon Connect instance<a class="hash-link" href="#add-the-lambda-function-to-your-amazon-connect-instance" title="Direct link to heading">​</a></h4><ol><li><p>In a new browser tab, login to the <a href="https://console.aws.amazon.com/" target="_blank" rel="noopener noreferrer"><strong>AWS
console</strong></a></p></li><li><p>Navigate to the <a href="https://console.aws.amazon.com/connect/home" target="_blank" rel="noopener noreferrer">Amazon Connect
Console</a></p></li><li><p>Select your <strong>Instance Alias</strong></p></li><li><p>In the navigation pane, choose <strong>Contact flows</strong>.</p></li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/image01.png" class="img_ev3q"><ol start="5"><li>For <strong>AWS Lambda</strong>, select the function that includes sfInvokeAPI in
the name</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/image02.png" class="img_ev3q"><ol start="6"><li>Choose <strong>Add Lambda Function</strong>. Confirm that the ARN of the function
is added under <strong>Lambda Functions</strong>.</li></ol><img loading="lazy" src="/amazon-connect-salesforce-cti/img/shared/image03.png" class="img_ev3q"><ol start="7"><li>The AWS Lambda function has been added to your Amazon Connect
instance.</li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/amazon-connect/amazon-connect-salesforce-cti/docs/lightning/02-installation/04-salesforce-lambdas-manual-setup.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/amazon-connect-salesforce-cti/docs/lightning/installation/03-managed-package-manual-setup"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Setting Up The CTI Adapter Managed Package Manually</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/amazon-connect-salesforce-cti/docs/lightning/installation/05-upgrading-from-an-earlier-version"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Upgrading from an Earlier Version</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#prerequisite-configuration-and-data-collection" class="table-of-contents__link toc-highlight">Prerequisite Configuration and Data Collection</a></li><li><a href="#check-your-salesforce-api-version" class="table-of-contents__link toc-highlight">Check your Salesforce API Version</a></li><li><a href="#create-a-new-api-user" class="table-of-contents__link toc-highlight">Create a new API user</a></li><li><a href="#gather-amazon-connect-information" class="table-of-contents__link toc-highlight">Gather Amazon Connect information</a></li><li><a href="#install-the-amazon-connect-salesforce-lambda-package" class="table-of-contents__link toc-highlight">Install the Amazon Connect Salesforce Lambda package</a></li><li><a href="#test-the-core-functionality" class="table-of-contents__link toc-highlight">Test the Core Functionality</a></li><li><a href="#allow-amazon-connect-to-access-the-sfinvokeapi-lambda-function" class="table-of-contents__link toc-highlight">Allow Amazon Connect to Access the sfInvokeAPI Lambda Function</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Amazon.com, Inc. or its affiliates. All Rights Reserved.</div></div></div></footer></div>
<script src="/amazon-connect-salesforce-cti/assets/js/runtime~main.ac9cd61b.js"></script>
<script src="/amazon-connect-salesforce-cti/assets/js/main.825280b4.js"></script>
</body>
</html>